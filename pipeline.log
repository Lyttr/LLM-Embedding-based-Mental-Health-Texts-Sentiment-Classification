2025-06-06 19:43:39,350 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 19:43:39,350 - INFO - Directory created or exists: plots
2025-06-06 19:43:39,350 - INFO - Directory created or exists: models
2025-06-06 19:43:39,351 - INFO - Directory created or exists: results
2025-06-06 19:43:39,363 - INFO - Use pytorch device_name: mps
2025-06-06 19:43:39,363 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-06-06 19:43:42,524 - INFO - Processing data...
2025-06-06 19:47:07,108 - INFO - Training ML models...
2025-06-06 19:47:07,109 - ERROR - Pipeline failed: 'label'
Traceback (most recent call last):
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'label'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/main.py", line 130, in main
    model_results = evaluate_embedding_models(processor, trainer, viz, df, df['label'])
                                                                           ~~^^^^^^^^^
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'label'
2025-06-06 19:48:28,318 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 19:48:28,318 - INFO - Directory created or exists: plots
2025-06-06 19:48:28,318 - INFO - Directory created or exists: models
2025-06-06 19:48:28,318 - INFO - Directory created or exists: results
2025-06-06 19:48:28,327 - INFO - Use pytorch device_name: mps
2025-06-06 19:48:28,327 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-06-06 19:48:30,296 - INFO - Processing data...
2025-06-06 19:50:42,727 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 19:50:42,727 - INFO - Directory created or exists: plots
2025-06-06 19:50:42,727 - INFO - Directory created or exists: models
2025-06-06 19:50:42,727 - INFO - Directory created or exists: results
2025-06-06 19:50:42,739 - INFO - Use pytorch device_name: mps
2025-06-06 19:50:42,739 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-06-06 19:50:44,651 - INFO - Processing data...
2025-06-06 19:50:44,878 - INFO - 原始数据行数: 53043
2025-06-06 19:50:44,883 - INFO - 删除空值后的行数: 52681
2025-06-06 19:50:44,887 - INFO - 
各类别数据分布:
2025-06-06 19:50:44,887 - INFO - Normal: 16343条
2025-06-06 19:50:44,887 - INFO - Depression: 15404条
2025-06-06 19:50:44,887 - INFO - Suicidal: 10652条
2025-06-06 19:50:44,887 - INFO - Anxiety: 3841条
2025-06-06 19:50:44,887 - INFO - Bipolar: 2777条
2025-06-06 19:50:44,887 - INFO - Stress: 2587条
2025-06-06 19:50:44,887 - INFO - Personality disorder: 1077条
2025-06-06 19:50:44,896 - INFO - 
文本长度统计:
2025-06-06 19:50:44,897 - INFO - 最短文本长度: 2
2025-06-06 19:50:44,897 - INFO - 最长文本长度: 32759
2025-06-06 19:50:44,897 - INFO - 平均文本长度: 578.71
2025-06-06 19:54:29,877 - INFO - Training ML models...
2025-06-06 19:54:29,879 - INFO - Embedding with: minilm
2025-06-06 19:54:29,884 - INFO - Use pytorch device_name: mps
2025-06-06 19:54:29,884 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-06-06 19:58:20,090 - ERROR - Embedding error (minilm): Failed to split data: Found input variables with inconsistent numbers of samples: [52681, 42144]
2025-06-06 19:58:20,092 - INFO - Embedding with: mpnet
2025-06-06 19:58:20,095 - INFO - Use pytorch device_name: mps
2025-06-06 19:58:20,095 - INFO - Load pretrained SentenceTransformer: all-mpnet-base-v2
2025-06-06 20:06:21,970 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 20:06:21,970 - INFO - Directory created or exists: plots
2025-06-06 20:06:21,970 - INFO - Directory created or exists: models
2025-06-06 20:06:21,970 - INFO - Directory created or exists: results
2025-06-06 20:06:21,985 - INFO - Use pytorch device_name: mps
2025-06-06 20:06:21,985 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-06-06 20:06:23,856 - INFO - Processing data...
2025-06-06 20:06:24,079 - INFO - 原始数据行数: 53043
2025-06-06 20:06:24,084 - INFO - 删除空值后的行数: 52681
2025-06-06 20:10:03,945 - ERROR - Visualization error: Could not interpret value `text_length` for `x`. An entry with this name does not appear in `data`.
2025-06-06 20:10:03,946 - INFO - Training ML models...
2025-06-06 20:10:03,946 - INFO - Training model: lr
2025-06-06 20:10:04,006 - ERROR - Training error (lr): Parameter grid for parameter 'max_iter' needs to be a list or a numpy array, but got 1000 (of type int) instead. Single values need to be wrapped in a list with one element.
2025-06-06 20:10:04,006 - INFO - Training model: rf
2025-06-06 20:10:04,012 - ERROR - Training error (rf): Parameter grid for parameter 'random_state' needs to be a list or a numpy array, but got 42 (of type int) instead. Single values need to be wrapped in a list with one element.
2025-06-06 20:10:04,012 - INFO - Training model: mlp
2025-06-06 20:10:04,013 - ERROR - Training error (mlp): Parameter grid for parameter 'max_iter' needs to be a list or a numpy array, but got 200 (of type int) instead. Single values need to be wrapped in a list with one element.
2025-06-06 20:10:04,013 - INFO - Training model: svm
2025-06-06 20:10:04,015 - ERROR - Training error (svm): Parameter grid for parameter 'random_state' needs to be a list or a numpy array, but got 42 (of type int) instead. Single values need to be wrapped in a list with one element.
2025-06-06 20:10:04,015 - ERROR - Metric plot error: list index out of range
2025-06-06 20:10:04,015 - INFO - Evaluating LLM baseline...
2025-06-06 20:10:04,015 - ERROR - Pipeline failed: 'numpy.ndarray' object has no attribute 'index'
Traceback (most recent call last):
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/main.py", line 123, in main
    llm_results = evaluate_llm(processor, trainer, viz, df, X_test.index, y_test)
                                                            ^^^^^^^^^^^^
AttributeError: 'numpy.ndarray' object has no attribute 'index'
2025-06-06 20:12:21,572 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 20:12:21,572 - INFO - Directory created or exists: plots
2025-06-06 20:12:21,572 - INFO - Directory created or exists: models
2025-06-06 20:12:21,572 - INFO - Directory created or exists: results
2025-06-06 20:12:21,580 - INFO - Use pytorch device_name: mps
2025-06-06 20:12:21,580 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-06-06 20:12:24,012 - INFO - Processing data...
2025-06-06 20:12:24,210 - INFO - 原始数据行数: 53043
2025-06-06 20:12:24,214 - INFO - 删除空值后的行数: 52681
2025-06-06 20:15:56,772 - INFO - Training ML models...
2025-06-06 20:15:56,773 - INFO - Generating embeddings with: minilm
2025-06-06 20:15:56,776 - INFO - Use pytorch device_name: mps
2025-06-06 20:15:56,776 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-06-06 20:19:44,379 - INFO - Saved embeddings for minilm
2025-06-06 20:19:44,432 - INFO - Training model: lr on embeddings: minilm
2025-06-06 20:22:06,517 - INFO - Saved model minilm_lr
2025-06-06 20:22:07,449 - INFO - Training model: rf on embeddings: minilm
2025-06-06 20:27:52,493 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 20:27:52,493 - INFO - Directory created or exists: plots
2025-06-06 20:27:52,493 - INFO - Directory created or exists: models
2025-06-06 20:27:52,493 - INFO - Directory created or exists: results
2025-06-06 20:27:52,510 - INFO - Use pytorch device_name: mps
2025-06-06 20:27:52,510 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-06-06 20:27:54,442 - INFO - Processing data...
2025-06-06 20:27:54,652 - INFO - 原始数据行数: 53043
2025-06-06 20:27:54,657 - INFO - 删除空值后的行数: 52681
2025-06-06 20:33:51,598 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 20:33:51,598 - INFO - Directory created or exists: plots
2025-06-06 20:33:51,598 - INFO - Directory created or exists: models
2025-06-06 20:33:51,598 - INFO - Directory created or exists: results
2025-06-06 20:33:51,598 - INFO - 
Processing with minilm model...
2025-06-06 20:33:51,607 - INFO - Use pytorch device_name: mps
2025-06-06 20:33:51,607 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-06-06 20:33:53,506 - INFO - Processing data...
2025-06-06 20:33:53,731 - INFO - 原始数据行数: 53043
2025-06-06 20:33:53,735 - INFO - 删除空值后的行数: 52681
2025-06-06 20:33:53,744 - ERROR - Pipeline failed: 'SentenceTransformer' object has no attribute 'get_config_dict'
Traceback (most recent call last):
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/main.py", line 143, in main
    X_train, X_test, y_train, y_test, df = processor.process_data()
                                           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/data_processor.py", line 117, in process_data
    embedding_path = f'models/embeddings_{self.model.get_config_dict()["model_name"]}.npy'
                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1931, in __getattr__
    raise AttributeError(
AttributeError: 'SentenceTransformer' object has no attribute 'get_config_dict'
2025-06-06 20:34:46,624 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 20:34:46,624 - INFO - Directory created or exists: plots
2025-06-06 20:34:46,624 - INFO - Directory created or exists: models
2025-06-06 20:34:46,624 - INFO - Directory created or exists: results
2025-06-06 20:34:46,625 - INFO - 
Processing with minilm model...
2025-06-06 20:34:46,636 - INFO - Use pytorch device_name: mps
2025-06-06 20:34:46,636 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-06-06 20:34:48,400 - INFO - Processing data...
2025-06-06 20:34:48,602 - INFO - 原始数据行数: 53043
2025-06-06 20:34:48,606 - INFO - 删除空值后的行数: 52681
2025-06-06 20:34:48,616 - INFO - Loading existing embeddings for minilm
2025-06-06 20:34:48,883 - ERROR - Visualization error: [Errno 2] No such file or directory: '/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/plots/plots/data_analysis/text_length_distribution.png'
2025-06-06 20:34:48,883 - INFO - Training ML models...
2025-06-06 20:34:48,883 - INFO - Loading existing model lr
2025-06-06 20:34:48,993 - ERROR - Pipeline failed: [Errno 2] No such file or directory: '/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/plots/plots/minilm/lr/confusion_matrix.png'
Traceback (most recent call last):
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/main.py", line 165, in main
    model_results = evaluate_embedding_models(processor, trainer, viz, X_train, X_test, y_train, y_test)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/main.py", line 74, in evaluate_embedding_models
    viz.plot_cm(y_test, metrics['y_pred'], processor.label_map,
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/visualizer.py", line 32, in plot_cm
    self._save_plot(filename)
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/visualizer.py", line 19, in _save_plot
    plt.savefig(os.path.join(self.save_dir, filename), bbox_inches='tight', dpi=300)
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/matplotlib/pyplot.py", line 1243, in savefig
    res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/matplotlib/figure.py", line 3490, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/matplotlib/backend_bases.py", line 2184, in print_figure
    result = print_method(
             ^^^^^^^^^^^^^
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/matplotlib/backend_bases.py", line 2040, in <lambda>
    print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
                                                                 ^^^^^
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/matplotlib/backends/backend_agg.py", line 481, in print_png
    self._print_pil(filename_or_obj, "png", pil_kwargs, metadata)
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/matplotlib/backends/backend_agg.py", line 430, in _print_pil
    mpl.image.imsave(
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/matplotlib/image.py", line 1634, in imsave
    image.save(fname, **pil_kwargs)
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/PIL/Image.py", line 2600, in save
    fp = builtins.open(filename, "w+b")
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/plots/plots/minilm/lr/confusion_matrix.png'
2025-06-06 20:35:40,958 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 20:35:40,959 - INFO - Directory created or exists: plots
2025-06-06 20:35:40,959 - INFO - Directory created or exists: models
2025-06-06 20:35:40,959 - INFO - Directory created or exists: results
2025-06-06 20:35:40,959 - INFO - 
Processing with minilm model...
2025-06-06 20:35:40,967 - INFO - Use pytorch device_name: mps
2025-06-06 20:35:40,967 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-06-06 20:35:42,763 - INFO - Processing data...
2025-06-06 20:35:42,968 - INFO - 原始数据行数: 53043
2025-06-06 20:35:42,972 - INFO - 删除空值后的行数: 52681
2025-06-06 20:35:42,982 - INFO - Loading existing embeddings for minilm
2025-06-06 20:35:49,327 - INFO - Training ML models...
2025-06-06 20:35:49,328 - INFO - Loading existing model lr
2025-06-06 20:35:50,171 - INFO - Training new model: rf
2025-06-06 20:45:23,544 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 20:45:23,544 - INFO - Directory created or exists: plots
2025-06-06 20:45:23,544 - INFO - Directory created or exists: models
2025-06-06 20:45:23,544 - INFO - Directory created or exists: results
2025-06-06 20:45:23,545 - INFO - 
Processing with minilm model...
2025-06-06 20:45:23,555 - INFO - Use pytorch device_name: mps
2025-06-06 20:45:23,555 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-06-06 20:45:25,658 - INFO - Processing data...
2025-06-06 20:45:25,866 - INFO - 原始数据行数: 53043
2025-06-06 20:45:25,870 - INFO - 删除空值后的行数: 52681
2025-06-06 20:45:25,880 - INFO - Loading existing embeddings for minilm
2025-06-06 20:45:32,220 - INFO - Training ML models...
2025-06-06 20:45:32,220 - INFO - Loading existing model lr
2025-06-06 20:45:33,055 - INFO - Training new model: rf
2025-06-06 20:46:29,211 - INFO - Saved model rf
2025-06-06 20:46:30,205 - INFO - Training new model: mlp
2025-06-06 20:46:30,378 - ERROR - Training error (mlp): Invalid parameter 'n_jobs' for estimator MLPClassifier(early_stopping=True, hidden_layer_sizes=(64,)). Valid parameters are: ['activation', 'alpha', 'batch_size', 'beta_1', 'beta_2', 'early_stopping', 'epsilon', 'hidden_layer_sizes', 'learning_rate', 'learning_rate_init', 'max_fun', 'max_iter', 'momentum', 'n_iter_no_change', 'nesterovs_momentum', 'power_t', 'random_state', 'shuffle', 'solver', 'tol', 'validation_fraction', 'verbose', 'warm_start'].
2025-06-06 20:46:30,378 - INFO - Training new model: svm
2025-06-06 20:50:08,303 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 20:50:08,303 - INFO - Directory created or exists: plots
2025-06-06 20:50:08,303 - INFO - Directory created or exists: models
2025-06-06 20:50:08,303 - INFO - Directory created or exists: results
2025-06-06 20:50:08,304 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 20:50:08,314 - INFO - Use pytorch device_name: mps
2025-06-06 20:50:08,315 - INFO - Load pretrained SentenceTransformer: {'model_name': 'sentence-transformers/all-MiniLM-L6-v2', 'max_length': 128}
2025-06-06 20:50:08,315 - ERROR - Pipeline failed: stat: path should be string, bytes, os.PathLike or integer, not dict
Traceback (most recent call last):
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/main.py", line 160, in main
    processor = DataProcessor(model_name=model_name)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/data_processor.py", line 17, in __init__
    self.model = SentenceTransformer(EMB_MODELS[model_name])
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/sentence_transformers/SentenceTransformer.py", line 293, in __init__
    if not os.path.exists(model_name_or_path):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen genericpath>", line 19, in exists
TypeError: stat: path should be string, bytes, os.PathLike or integer, not dict
2025-06-06 20:50:54,236 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 20:50:54,236 - INFO - Directory created or exists: plots
2025-06-06 20:50:54,236 - INFO - Directory created or exists: models
2025-06-06 20:50:54,236 - INFO - Directory created or exists: results
2025-06-06 20:50:54,236 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 20:50:54,245 - INFO - Use pytorch device_name: mps
2025-06-06 20:50:54,246 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 20:50:56,541 - INFO - Processing data...
2025-06-06 20:50:56,545 - ERROR - Error loading data: [Errno 2] No such file or directory: 'data/mental_health.csv'
2025-06-06 20:50:56,545 - ERROR - Pipeline failed: [Errno 2] No such file or directory: 'data/mental_health.csv'
Traceback (most recent call last):
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/main.py", line 164, in main
    X_train, X_test, y_train, y_test, df = processor.process_data()
                                           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/data_processor.py", line 63, in process_data
    df = self.load_data()
         ^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/data_processor.py", line 24, in load_data
    df = pd.read_csv(filepath)
         ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/pandas/io/common.py", line 873, in get_handle
    handle = open(
             ^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'data/mental_health.csv'
2025-06-06 20:53:29,232 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 20:53:29,232 - INFO - Directory created or exists: plots
2025-06-06 20:53:29,232 - INFO - Directory created or exists: models
2025-06-06 20:53:29,232 - INFO - Directory created or exists: results
2025-06-06 20:53:29,232 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 20:53:29,241 - INFO - Use pytorch device_name: mps
2025-06-06 20:53:29,241 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 20:53:31,253 - INFO - Processing data...
2025-06-06 20:53:31,469 - INFO - Loaded 53043 samples from data/Combined Data.csv
2025-06-06 20:53:31,481 - INFO - Generating embeddings using all-MiniLM-L6-v2
2025-06-06 20:59:08,972 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 20:59:08,972 - INFO - Directory created or exists: plots
2025-06-06 20:59:08,972 - INFO - Directory created or exists: models
2025-06-06 20:59:08,972 - INFO - Directory created or exists: results
2025-06-06 20:59:08,973 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 20:59:08,982 - INFO - Use pytorch device_name: mps
2025-06-06 20:59:08,982 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 20:59:11,046 - INFO - Processing data...
2025-06-06 20:59:11,255 - INFO - Loaded 53043 samples from data/Combined Data.csv
2025-06-06 20:59:11,265 - INFO - Generating embeddings using all-MiniLM-L6-v2
2025-06-06 21:01:06,925 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 21:01:06,926 - INFO - Directory created or exists: plots
2025-06-06 21:01:06,926 - INFO - Directory created or exists: models
2025-06-06 21:01:06,926 - INFO - Directory created or exists: results
2025-06-06 21:01:06,926 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 21:01:06,936 - INFO - Use pytorch device_name: mps
2025-06-06 21:01:06,936 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 21:01:09,105 - INFO - Processing data...
2025-06-06 21:01:09,329 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 21:01:09,339 - INFO - Generating embeddings using all-MiniLM-L6-v2
2025-06-06 21:04:39,234 - INFO - Saved embeddings to models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 21:04:46,193 - INFO - Training ML models...
2025-06-06 21:04:46,194 - INFO - Training new model: lr
2025-06-06 21:04:46,229 - ERROR - Training error (lr): Parameter grid for parameter 'n_jobs' needs to be a list or a numpy array, but got -1 (of type int) instead. Single values need to be wrapped in a list with one element.
2025-06-06 21:04:46,230 - INFO - Training new model: rf
2025-06-06 21:04:46,232 - ERROR - Training error (rf): Parameter grid for parameter 'n_jobs' needs to be a list or a numpy array, but got -1 (of type int) instead. Single values need to be wrapped in a list with one element.
2025-06-06 21:04:46,232 - INFO - Training new model: mlp
2025-06-06 21:05:09,995 - INFO - Saved model mlp
2025-06-06 21:05:11,403 - INFO - Training new model: svm
2025-06-06 21:05:11,404 - ERROR - Training error (svm): Parameter grid for parameter 'n_jobs' needs to be a list or a numpy array, but got -1 (of type int) instead. Single values need to be wrapped in a list with one element.
2025-06-06 21:05:11,416 - ERROR - Metric plot error: only length-1 arrays can be converted to Python scalars
2025-06-06 21:05:11,416 - INFO - 
Processing with all-mpnet-base-v2 model...
2025-06-06 21:05:11,418 - INFO - Use pytorch device_name: mps
2025-06-06 21:05:11,418 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-mpnet-base-v2
2025-06-06 21:05:23,708 - INFO - Processing data...
2025-06-06 21:05:23,968 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 21:05:23,978 - INFO - Generating embeddings using all-mpnet-base-v2
2025-06-06 21:09:48,385 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 21:09:48,385 - INFO - Directory created or exists: plots
2025-06-06 21:09:48,385 - INFO - Directory created or exists: models
2025-06-06 21:09:48,385 - INFO - Directory created or exists: results
2025-06-06 21:09:48,385 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 21:09:48,402 - INFO - Use pytorch device_name: mps
2025-06-06 21:09:48,403 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 21:09:50,249 - INFO - Processing data...
2025-06-06 21:09:50,465 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 21:09:50,476 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 21:09:56,828 - INFO - Training ML models...
2025-06-06 21:09:56,828 - INFO - Training new model: lr
2025-06-06 21:10:27,930 - INFO - Saved model lr
2025-06-06 21:10:28,849 - INFO - Training new model: rf
2025-06-06 21:11:28,225 - INFO - Saved model rf
2025-06-06 21:11:29,136 - INFO - Loading existing model mlp
2025-06-06 21:11:29,961 - INFO - Training new model: svm
2025-06-06 21:11:30,096 - ERROR - Training error (svm): Invalid parameter 'n_jobs' for estimator SVC(C=0.1, probability=True, random_state=42). Valid parameters are: ['C', 'break_ties', 'cache_size', 'class_weight', 'coef0', 'decision_function_shape', 'degree', 'gamma', 'kernel', 'max_iter', 'probability', 'random_state', 'shrinking', 'tol', 'verbose'].
2025-06-06 21:11:30,107 - ERROR - Metric plot error: shape mismatch: objects cannot be broadcast to a single shape.  Mismatch is between arg 0 with shape (3,) and arg 1 with shape (3, 10537).
2025-06-06 21:11:30,107 - INFO - 
Processing with all-mpnet-base-v2 model...
2025-06-06 21:11:30,110 - INFO - Use pytorch device_name: mps
2025-06-06 21:11:30,110 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-mpnet-base-v2
2025-06-06 21:11:32,063 - INFO - Processing data...
2025-06-06 21:11:32,267 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 21:11:32,276 - INFO - Generating embeddings using all-mpnet-base-v2
2025-06-06 21:13:55,717 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 21:13:55,718 - INFO - Directory created or exists: plots
2025-06-06 21:13:55,718 - INFO - Directory created or exists: models
2025-06-06 21:13:55,718 - INFO - Directory created or exists: results
2025-06-06 21:13:55,718 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 21:13:55,728 - INFO - Use pytorch device_name: mps
2025-06-06 21:13:55,728 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 21:13:57,974 - INFO - Processing data...
2025-06-06 21:13:58,186 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 21:13:58,196 - INFO - Mental health status distribution in dataset:
2025-06-06 21:13:58,197 - INFO - Normal: 16343 samples
2025-06-06 21:13:58,197 - INFO - Depression: 15404 samples
2025-06-06 21:13:58,197 - INFO - Suicidal: 10652 samples
2025-06-06 21:13:58,197 - INFO - Anxiety: 3841 samples
2025-06-06 21:13:58,197 - INFO - Bipolar: 2777 samples
2025-06-06 21:13:58,197 - INFO - Stress: 2587 samples
2025-06-06 21:13:58,197 - INFO - Personality disorder: 1077 samples
2025-06-06 21:13:58,197 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 21:13:58,199 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 21:14:04,500 - INFO - Training ML models...
2025-06-06 21:14:04,501 - INFO - Loading existing model lr
2025-06-06 21:14:05,336 - INFO - Loading existing model rf
2025-06-06 21:14:06,181 - INFO - Loading existing model mlp
2025-06-06 21:14:07,006 - INFO - Training new model: svm
2025-06-06 21:14:08,824 - ERROR - Training error (svm): Invalid parameter 'n_jobs' for estimator SVC(C=0.1, probability=True, random_state=42). Valid parameters are: ['C', 'break_ties', 'cache_size', 'class_weight', 'coef0', 'decision_function_shape', 'degree', 'gamma', 'kernel', 'max_iter', 'probability', 'random_state', 'shrinking', 'tol', 'verbose'].
2025-06-06 21:14:08,836 - ERROR - Metric plot error: shape mismatch: objects cannot be broadcast to a single shape.  Mismatch is between arg 0 with shape (3,) and arg 1 with shape (3, 10537).
2025-06-06 21:14:08,837 - INFO - 
Processing with all-mpnet-base-v2 model...
2025-06-06 21:14:08,839 - INFO - Use pytorch device_name: mps
2025-06-06 21:14:08,839 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-mpnet-base-v2
2025-06-06 21:14:10,870 - INFO - Processing data...
2025-06-06 21:14:11,083 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 21:14:11,091 - INFO - Mental health status distribution in dataset:
2025-06-06 21:14:11,091 - INFO - Normal: 16343 samples
2025-06-06 21:14:11,091 - INFO - Depression: 15404 samples
2025-06-06 21:14:11,091 - INFO - Suicidal: 10652 samples
2025-06-06 21:14:11,091 - INFO - Anxiety: 3841 samples
2025-06-06 21:14:11,091 - INFO - Bipolar: 2777 samples
2025-06-06 21:14:11,091 - INFO - Stress: 2587 samples
2025-06-06 21:14:11,091 - INFO - Personality disorder: 1077 samples
2025-06-06 21:14:11,091 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 21:14:11,093 - INFO - Generating embeddings using all-mpnet-base-v2
2025-06-06 21:15:52,752 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 21:15:52,752 - INFO - Directory created or exists: plots
2025-06-06 21:15:52,752 - INFO - Directory created or exists: models
2025-06-06 21:15:52,752 - INFO - Directory created or exists: results
2025-06-06 21:15:52,753 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 21:15:52,764 - INFO - Use pytorch device_name: mps
2025-06-06 21:15:52,764 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 21:15:54,812 - INFO - Processing data...
2025-06-06 21:15:55,034 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 21:15:55,045 - INFO - Mental health status distribution in dataset:
2025-06-06 21:15:55,045 - INFO - Normal: 16343 samples
2025-06-06 21:15:55,045 - INFO - Depression: 15404 samples
2025-06-06 21:15:55,045 - INFO - Suicidal: 10652 samples
2025-06-06 21:15:55,045 - INFO - Anxiety: 3841 samples
2025-06-06 21:15:55,045 - INFO - Bipolar: 2777 samples
2025-06-06 21:15:55,045 - INFO - Stress: 2587 samples
2025-06-06 21:15:55,045 - INFO - Personality disorder: 1077 samples
2025-06-06 21:15:55,045 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 21:15:55,049 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 21:16:01,444 - INFO - Training ML models...
2025-06-06 21:16:01,445 - INFO - Loading existing model lr
2025-06-06 21:16:01,462 - INFO - 
Classification Report:
2025-06-06 21:16:01,465 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.80      0.77      0.79       768
             Bipolar       0.83      0.76      0.79       556
          Depression       0.69      0.74      0.72      3081
              Normal       0.89      0.93      0.91      3269
Personality disorder       0.73      0.53      0.61       215
              Stress       0.62      0.54      0.58       517
            Suicidal       0.67      0.62      0.64      2131

            accuracy                           0.76     10537
           macro avg       0.75      0.70      0.72     10537
        weighted avg       0.76      0.76      0.76     10537

2025-06-06 21:16:01,465 - INFO - Accuracy: 0.7646
2025-06-06 21:16:01,465 - INFO - Weighted Precision: 0.7617
2025-06-06 21:16:01,465 - INFO - Weighted Recall: 0.7646
2025-06-06 21:16:01,465 - INFO - Weighted F1 Score: 0.7619
2025-06-06 21:16:01,613 - ERROR - Pipeline failed: 'fpr'
Traceback (most recent call last):
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/main.py", line 186, in main
    model_results = evaluate_embedding_models(processor, trainer, viz, X_train, X_test, y_train, y_test)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/main.py", line 99, in evaluate_embedding_models
    viz.plot_roc_curve(metrics['fpr'][label], metrics['tpr'][label],
                       ~~~~~~~^^^^^^^
KeyError: 'fpr'
2025-06-06 21:16:53,874 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 21:16:53,874 - INFO - Directory created or exists: plots
2025-06-06 21:16:53,874 - INFO - Directory created or exists: models
2025-06-06 21:16:53,874 - INFO - Directory created or exists: results
2025-06-06 21:16:53,874 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 21:16:53,882 - INFO - Use pytorch device_name: mps
2025-06-06 21:16:53,882 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 21:16:56,258 - INFO - Processing data...
2025-06-06 21:16:56,470 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 21:16:56,481 - INFO - Mental health status distribution in dataset:
2025-06-06 21:16:56,481 - INFO - Normal: 16343 samples
2025-06-06 21:16:56,481 - INFO - Depression: 15404 samples
2025-06-06 21:16:56,481 - INFO - Suicidal: 10652 samples
2025-06-06 21:16:56,481 - INFO - Anxiety: 3841 samples
2025-06-06 21:16:56,481 - INFO - Bipolar: 2777 samples
2025-06-06 21:16:56,481 - INFO - Stress: 2587 samples
2025-06-06 21:16:56,481 - INFO - Personality disorder: 1077 samples
2025-06-06 21:16:56,481 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 21:16:56,483 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 21:17:02,850 - INFO - Training ML models...
2025-06-06 21:17:02,851 - INFO - Loading existing model lr
2025-06-06 21:17:02,868 - INFO - 
Classification Report:
2025-06-06 21:17:02,871 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.80      0.77      0.79       768
             Bipolar       0.83      0.76      0.79       556
          Depression       0.69      0.74      0.72      3081
              Normal       0.89      0.93      0.91      3269
Personality disorder       0.73      0.53      0.61       215
              Stress       0.62      0.54      0.58       517
            Suicidal       0.67      0.62      0.64      2131

            accuracy                           0.76     10537
           macro avg       0.75      0.70      0.72     10537
        weighted avg       0.76      0.76      0.76     10537

2025-06-06 21:17:02,871 - INFO - Accuracy: 0.7646
2025-06-06 21:17:02,871 - INFO - Weighted Precision: 0.7617
2025-06-06 21:17:02,871 - INFO - Weighted Recall: 0.7646
2025-06-06 21:17:02,871 - INFO - Weighted F1 Score: 0.7619
2025-06-06 21:17:03,017 - INFO - Loading existing model rf
2025-06-06 21:17:03,046 - INFO - 
Classification Report:
2025-06-06 21:17:03,050 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.82      0.50      0.62       768
             Bipolar       0.96      0.28      0.43       556
          Depression       0.54      0.80      0.64      3081
              Normal       0.77      0.96      0.86      3269
Personality disorder       1.00      0.01      0.02       215
              Stress       1.00      0.03      0.07       517
            Suicidal       0.70      0.39      0.50      2131

            accuracy                           0.67     10537
           macro avg       0.83      0.43      0.45     10537
        weighted avg       0.72      0.67      0.63     10537

2025-06-06 21:17:03,050 - INFO - Accuracy: 0.6657
2025-06-06 21:17:03,050 - INFO - Weighted Precision: 0.7172
2025-06-06 21:17:03,050 - INFO - Weighted Recall: 0.6657
2025-06-06 21:17:03,050 - INFO - Weighted F1 Score: 0.6270
2025-06-06 21:17:03,192 - INFO - Loading existing model mlp
2025-06-06 21:17:03,206 - INFO - 
Classification Report:
2025-06-06 21:17:03,210 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.81      0.79      0.80       768
             Bipolar       0.80      0.77      0.78       556
          Depression       0.71      0.75      0.73      3081
              Normal       0.91      0.94      0.92      3269
Personality disorder       0.71      0.56      0.63       215
              Stress       0.65      0.55      0.60       517
            Suicidal       0.68      0.64      0.66      2131

            accuracy                           0.78     10537
           macro avg       0.75      0.71      0.73     10537
        weighted avg       0.77      0.78      0.78     10537

2025-06-06 21:17:03,210 - INFO - Accuracy: 0.7772
2025-06-06 21:17:03,210 - INFO - Weighted Precision: 0.7750
2025-06-06 21:17:03,210 - INFO - Weighted Recall: 0.7772
2025-06-06 21:17:03,210 - INFO - Weighted F1 Score: 0.7752
2025-06-06 21:17:03,354 - INFO - Training new model: svm
2025-06-06 21:17:04,865 - ERROR - Training error (svm): Invalid parameter 'n_jobs' for estimator SVC(C=0.1, probability=True, random_state=42). Valid parameters are: ['C', 'break_ties', 'cache_size', 'class_weight', 'coef0', 'decision_function_shape', 'degree', 'gamma', 'kernel', 'max_iter', 'probability', 'random_state', 'shrinking', 'tol', 'verbose'].
2025-06-06 21:17:04,877 - ERROR - Metric plot error: shape mismatch: objects cannot be broadcast to a single shape.  Mismatch is between arg 0 with shape (3,) and arg 1 with shape (3, 10537).
2025-06-06 21:17:04,877 - INFO - 
Processing with all-mpnet-base-v2 model...
2025-06-06 21:17:04,879 - INFO - Use pytorch device_name: mps
2025-06-06 21:17:04,879 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-mpnet-base-v2
2025-06-06 21:17:07,198 - INFO - Processing data...
2025-06-06 21:17:07,416 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 21:17:07,425 - INFO - Mental health status distribution in dataset:
2025-06-06 21:17:07,425 - INFO - Normal: 16343 samples
2025-06-06 21:17:07,425 - INFO - Depression: 15404 samples
2025-06-06 21:17:07,425 - INFO - Suicidal: 10652 samples
2025-06-06 21:17:07,425 - INFO - Anxiety: 3841 samples
2025-06-06 21:17:07,425 - INFO - Bipolar: 2777 samples
2025-06-06 21:17:07,425 - INFO - Stress: 2587 samples
2025-06-06 21:17:07,425 - INFO - Personality disorder: 1077 samples
2025-06-06 21:17:07,425 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 21:17:07,426 - INFO - Generating embeddings using all-mpnet-base-v2
2025-06-06 21:18:30,233 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 21:18:30,233 - INFO - Directory created or exists: plots
2025-06-06 21:18:30,233 - INFO - Directory created or exists: models
2025-06-06 21:18:30,233 - INFO - Directory created or exists: results
2025-06-06 21:18:30,234 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 21:18:30,248 - INFO - Use pytorch device_name: mps
2025-06-06 21:18:30,248 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 21:18:32,304 - INFO - Processing data...
2025-06-06 21:18:32,520 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 21:18:32,531 - INFO - Mental health status distribution in dataset:
2025-06-06 21:18:32,532 - INFO - Normal: 16343 samples
2025-06-06 21:18:32,532 - INFO - Depression: 15404 samples
2025-06-06 21:18:32,532 - INFO - Suicidal: 10652 samples
2025-06-06 21:18:32,532 - INFO - Anxiety: 3841 samples
2025-06-06 21:18:32,532 - INFO - Bipolar: 2777 samples
2025-06-06 21:18:32,532 - INFO - Stress: 2587 samples
2025-06-06 21:18:32,532 - INFO - Personality disorder: 1077 samples
2025-06-06 21:18:32,532 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 21:18:32,533 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 21:18:39,055 - INFO - Training ML models...
2025-06-06 21:18:39,056 - INFO - Loading existing model lr
2025-06-06 21:18:39,073 - INFO - 
Classification Report:
2025-06-06 21:18:39,077 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.80      0.77      0.79       768
             Bipolar       0.83      0.76      0.79       556
          Depression       0.69      0.74      0.72      3081
              Normal       0.89      0.93      0.91      3269
Personality disorder       0.73      0.53      0.61       215
              Stress       0.62      0.54      0.58       517
            Suicidal       0.67      0.62      0.64      2131

            accuracy                           0.76     10537
           macro avg       0.75      0.70      0.72     10537
        weighted avg       0.76      0.76      0.76     10537

2025-06-06 21:18:39,077 - INFO - Accuracy: 0.7646
2025-06-06 21:18:39,077 - INFO - Weighted Precision: 0.7617
2025-06-06 21:18:39,077 - INFO - Weighted Recall: 0.7646
2025-06-06 21:18:39,077 - INFO - Weighted F1 Score: 0.7619
2025-06-06 21:18:39,227 - INFO - Loading existing model rf
2025-06-06 21:18:39,257 - INFO - 
Classification Report:
2025-06-06 21:18:39,261 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.82      0.50      0.62       768
             Bipolar       0.96      0.28      0.43       556
          Depression       0.54      0.80      0.64      3081
              Normal       0.77      0.96      0.86      3269
Personality disorder       1.00      0.01      0.02       215
              Stress       1.00      0.03      0.07       517
            Suicidal       0.70      0.39      0.50      2131

            accuracy                           0.67     10537
           macro avg       0.83      0.43      0.45     10537
        weighted avg       0.72      0.67      0.63     10537

2025-06-06 21:18:39,261 - INFO - Accuracy: 0.6657
2025-06-06 21:18:39,261 - INFO - Weighted Precision: 0.7172
2025-06-06 21:18:39,261 - INFO - Weighted Recall: 0.6657
2025-06-06 21:18:39,261 - INFO - Weighted F1 Score: 0.6270
2025-06-06 21:18:39,405 - INFO - Loading existing model mlp
2025-06-06 21:18:39,417 - INFO - 
Classification Report:
2025-06-06 21:18:39,420 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.81      0.79      0.80       768
             Bipolar       0.80      0.77      0.78       556
          Depression       0.71      0.75      0.73      3081
              Normal       0.91      0.94      0.92      3269
Personality disorder       0.71      0.56      0.63       215
              Stress       0.65      0.55      0.60       517
            Suicidal       0.68      0.64      0.66      2131

            accuracy                           0.78     10537
           macro avg       0.75      0.71      0.73     10537
        weighted avg       0.77      0.78      0.78     10537

2025-06-06 21:18:39,420 - INFO - Accuracy: 0.7772
2025-06-06 21:18:39,420 - INFO - Weighted Precision: 0.7750
2025-06-06 21:18:39,421 - INFO - Weighted Recall: 0.7772
2025-06-06 21:18:39,421 - INFO - Weighted F1 Score: 0.7752
2025-06-06 21:18:39,568 - INFO - Training new model: svm
2025-06-06 21:35:18,457 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 21:35:18,457 - INFO - Directory created or exists: plots
2025-06-06 21:35:18,457 - INFO - Directory created or exists: models
2025-06-06 21:35:18,457 - INFO - Directory created or exists: results
2025-06-06 21:35:18,458 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 21:35:18,471 - INFO - Use pytorch device_name: mps
2025-06-06 21:35:18,471 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 21:35:20,694 - INFO - Processing data...
2025-06-06 21:35:20,929 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 21:35:20,940 - INFO - Mental health status distribution in dataset:
2025-06-06 21:35:20,940 - INFO - Normal: 16343 samples
2025-06-06 21:35:20,940 - INFO - Depression: 15404 samples
2025-06-06 21:35:20,940 - INFO - Suicidal: 10652 samples
2025-06-06 21:35:20,940 - INFO - Anxiety: 3841 samples
2025-06-06 21:35:20,940 - INFO - Bipolar: 2777 samples
2025-06-06 21:35:20,940 - INFO - Stress: 2587 samples
2025-06-06 21:35:20,940 - INFO - Personality disorder: 1077 samples
2025-06-06 21:35:20,940 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 21:35:20,942 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 21:35:27,413 - INFO - Training ML models...
2025-06-06 21:35:27,414 - INFO - Loading existing model lr
2025-06-06 21:35:27,431 - INFO - 
Classification Report:
2025-06-06 21:35:27,435 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.62      0.82      0.70       768
             Bipolar       0.43      0.84      0.57       556
          Depression       0.82      0.39      0.53      3081
              Normal       0.89      0.90      0.90      3269
Personality disorder       0.17      0.79      0.28       215
              Stress       0.38      0.67      0.48       517
            Suicidal       0.68      0.56      0.61      2131

            accuracy                           0.66     10537
           macro avg       0.57      0.71      0.58     10537
        weighted avg       0.74      0.66      0.67     10537

2025-06-06 21:35:27,435 - INFO - Accuracy: 0.6594
2025-06-06 21:35:27,435 - INFO - Weighted Precision: 0.7430
2025-06-06 21:35:27,435 - INFO - Weighted Recall: 0.6594
2025-06-06 21:35:27,435 - INFO - Weighted F1 Score: 0.6665
2025-06-06 21:35:27,587 - INFO - Loading existing model rf
2025-06-06 21:35:27,629 - INFO - 
Classification Report:
2025-06-06 21:35:27,633 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.68      0.58      0.63       768
             Bipolar       0.90      0.33      0.48       556
          Depression       0.55      0.70      0.62      3081
              Normal       0.73      0.94      0.82      3269
Personality disorder       1.00      0.01      0.02       215
              Stress       0.70      0.06      0.11       517
            Suicidal       0.56      0.40      0.46      2131

            accuracy                           0.64     10537
           macro avg       0.73      0.43      0.45     10537
        weighted avg       0.65      0.64      0.60     10537

2025-06-06 21:35:27,633 - INFO - Accuracy: 0.6382
2025-06-06 21:35:27,633 - INFO - Weighted Precision: 0.6515
2025-06-06 21:35:27,633 - INFO - Weighted Recall: 0.6382
2025-06-06 21:35:27,633 - INFO - Weighted F1 Score: 0.6050
2025-06-06 21:35:27,777 - INFO - Loading existing model mlp
2025-06-06 21:35:27,789 - INFO - 
Classification Report:
2025-06-06 21:35:27,793 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.71      0.78      0.74       768
             Bipolar       0.63      0.79      0.70       556
          Depression       0.74      0.61      0.67      3081
              Normal       0.78      0.97      0.87      3269
Personality disorder       0.40      0.62      0.49       215
              Stress       0.43      0.61      0.50       517
            Suicidal       0.73      0.45      0.56      2131

            accuracy                           0.71     10537
           macro avg       0.63      0.69      0.65     10537
        weighted avg       0.72      0.71      0.70     10537

2025-06-06 21:35:27,793 - INFO - Accuracy: 0.7137
2025-06-06 21:35:27,793 - INFO - Weighted Precision: 0.7210
2025-06-06 21:35:27,793 - INFO - Weighted Recall: 0.7137
2025-06-06 21:35:27,793 - INFO - Weighted F1 Score: 0.7042
2025-06-06 21:35:27,945 - INFO - Training new model: svm
2025-06-06 21:36:04,023 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 21:36:04,023 - INFO - Directory created or exists: plots
2025-06-06 21:36:04,024 - INFO - Directory created or exists: models
2025-06-06 21:36:04,024 - INFO - Directory created or exists: results
2025-06-06 21:36:04,024 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 21:36:04,033 - INFO - Use pytorch device_name: mps
2025-06-06 21:36:04,033 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 21:36:05,885 - INFO - Processing data...
2025-06-06 21:36:06,114 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 21:36:06,125 - INFO - Mental health status distribution in dataset:
2025-06-06 21:36:06,125 - INFO - Normal: 16343 samples
2025-06-06 21:36:06,125 - INFO - Depression: 15404 samples
2025-06-06 21:36:06,125 - INFO - Suicidal: 10652 samples
2025-06-06 21:36:06,126 - INFO - Anxiety: 3841 samples
2025-06-06 21:36:06,126 - INFO - Bipolar: 2777 samples
2025-06-06 21:36:06,126 - INFO - Stress: 2587 samples
2025-06-06 21:36:06,126 - INFO - Personality disorder: 1077 samples
2025-06-06 21:36:06,127 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 21:36:06,129 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 21:36:12,604 - INFO - Training ML models...
2025-06-06 21:36:12,605 - INFO - Training new model: lr
2025-06-06 21:36:40,191 - INFO - 
Classification Report:
2025-06-06 21:36:40,195 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.81      0.77      0.79       768
             Bipolar       0.81      0.76      0.78       556
          Depression       0.70      0.75      0.72      3081
              Normal       0.89      0.93      0.91      3269
Personality disorder       0.71      0.53      0.61       215
              Stress       0.63      0.56      0.59       517
            Suicidal       0.68      0.62      0.65      2131

            accuracy                           0.77     10537
           macro avg       0.75      0.70      0.72     10537
        weighted avg       0.77      0.77      0.77     10537

2025-06-06 21:36:40,195 - INFO - Accuracy: 0.7676
2025-06-06 21:36:40,195 - INFO - Weighted Precision: 0.7651
2025-06-06 21:36:40,195 - INFO - Weighted Recall: 0.7676
2025-06-06 21:36:40,195 - INFO - Weighted F1 Score: 0.7652
2025-06-06 21:36:40,197 - INFO - Saved model lr
2025-06-06 21:36:40,470 - INFO - Training new model: rf
2025-06-06 21:37:40,695 - INFO - 
Classification Report:
2025-06-06 21:37:40,700 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.82      0.50      0.62       768
             Bipolar       0.96      0.28      0.43       556
          Depression       0.54      0.80      0.64      3081
              Normal       0.77      0.96      0.86      3269
Personality disorder       1.00      0.01      0.02       215
              Stress       1.00      0.03      0.07       517
            Suicidal       0.70      0.39      0.50      2131

            accuracy                           0.67     10537
           macro avg       0.83      0.43      0.45     10537
        weighted avg       0.72      0.67      0.63     10537

2025-06-06 21:37:40,700 - INFO - Accuracy: 0.6657
2025-06-06 21:37:40,700 - INFO - Weighted Precision: 0.7172
2025-06-06 21:37:40,700 - INFO - Weighted Recall: 0.6657
2025-06-06 21:37:40,700 - INFO - Weighted F1 Score: 0.6270
2025-06-06 21:37:40,714 - INFO - Saved model rf
2025-06-06 21:37:40,993 - INFO - Training new model: mlp
2025-06-06 21:37:50,846 - INFO - 
Classification Report:
2025-06-06 21:37:50,851 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.82      0.77      0.79       768
             Bipolar       0.83      0.75      0.79       556
          Depression       0.71      0.74      0.73      3081
              Normal       0.91      0.94      0.92      3269
Personality disorder       0.72      0.57      0.64       215
              Stress       0.60      0.60      0.60       517
            Suicidal       0.67      0.65      0.66      2131

            accuracy                           0.77     10537
           macro avg       0.75      0.72      0.73     10537
        weighted avg       0.77      0.77      0.77     10537

2025-06-06 21:37:50,851 - INFO - Accuracy: 0.7738
2025-06-06 21:37:50,851 - INFO - Weighted Precision: 0.7726
2025-06-06 21:37:50,851 - INFO - Weighted Recall: 0.7738
2025-06-06 21:37:50,851 - INFO - Weighted F1 Score: 0.7727
2025-06-06 21:37:50,853 - INFO - Saved model mlp
2025-06-06 21:37:51,130 - INFO - Training new model: svm
