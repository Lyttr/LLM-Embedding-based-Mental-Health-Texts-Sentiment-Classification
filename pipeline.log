2025-06-06 19:43:39,350 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 19:43:39,350 - INFO - Directory created or exists: plots
2025-06-06 19:43:39,350 - INFO - Directory created or exists: models
2025-06-06 19:43:39,351 - INFO - Directory created or exists: results
2025-06-06 19:43:39,363 - INFO - Use pytorch device_name: mps
2025-06-06 19:43:39,363 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-06-06 19:43:42,524 - INFO - Processing data...
2025-06-06 19:47:07,108 - INFO - Training ML models...
2025-06-06 19:47:07,109 - ERROR - Pipeline failed: 'label'
Traceback (most recent call last):
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'label'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/main.py", line 130, in main
    model_results = evaluate_embedding_models(processor, trainer, viz, df, df['label'])
                                                                           ~~^^^^^^^^^
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'label'
2025-06-06 19:48:28,318 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 19:48:28,318 - INFO - Directory created or exists: plots
2025-06-06 19:48:28,318 - INFO - Directory created or exists: models
2025-06-06 19:48:28,318 - INFO - Directory created or exists: results
2025-06-06 19:48:28,327 - INFO - Use pytorch device_name: mps
2025-06-06 19:48:28,327 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-06-06 19:48:30,296 - INFO - Processing data...
2025-06-06 19:50:42,727 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 19:50:42,727 - INFO - Directory created or exists: plots
2025-06-06 19:50:42,727 - INFO - Directory created or exists: models
2025-06-06 19:50:42,727 - INFO - Directory created or exists: results
2025-06-06 19:50:42,739 - INFO - Use pytorch device_name: mps
2025-06-06 19:50:42,739 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-06-06 19:50:44,651 - INFO - Processing data...
2025-06-06 19:50:44,878 - INFO - 原始数据行数: 53043
2025-06-06 19:50:44,883 - INFO - 删除空值后的行数: 52681
2025-06-06 19:50:44,887 - INFO - 
各类别数据分布:
2025-06-06 19:50:44,887 - INFO - Normal: 16343条
2025-06-06 19:50:44,887 - INFO - Depression: 15404条
2025-06-06 19:50:44,887 - INFO - Suicidal: 10652条
2025-06-06 19:50:44,887 - INFO - Anxiety: 3841条
2025-06-06 19:50:44,887 - INFO - Bipolar: 2777条
2025-06-06 19:50:44,887 - INFO - Stress: 2587条
2025-06-06 19:50:44,887 - INFO - Personality disorder: 1077条
2025-06-06 19:50:44,896 - INFO - 
文本长度统计:
2025-06-06 19:50:44,897 - INFO - 最短文本长度: 2
2025-06-06 19:50:44,897 - INFO - 最长文本长度: 32759
2025-06-06 19:50:44,897 - INFO - 平均文本长度: 578.71
2025-06-06 19:54:29,877 - INFO - Training ML models...
2025-06-06 19:54:29,879 - INFO - Embedding with: minilm
2025-06-06 19:54:29,884 - INFO - Use pytorch device_name: mps
2025-06-06 19:54:29,884 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-06-06 19:58:20,090 - ERROR - Embedding error (minilm): Failed to split data: Found input variables with inconsistent numbers of samples: [52681, 42144]
2025-06-06 19:58:20,092 - INFO - Embedding with: mpnet
2025-06-06 19:58:20,095 - INFO - Use pytorch device_name: mps
2025-06-06 19:58:20,095 - INFO - Load pretrained SentenceTransformer: all-mpnet-base-v2
2025-06-06 20:06:21,970 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 20:06:21,970 - INFO - Directory created or exists: plots
2025-06-06 20:06:21,970 - INFO - Directory created or exists: models
2025-06-06 20:06:21,970 - INFO - Directory created or exists: results
2025-06-06 20:06:21,985 - INFO - Use pytorch device_name: mps
2025-06-06 20:06:21,985 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-06-06 20:06:23,856 - INFO - Processing data...
2025-06-06 20:06:24,079 - INFO - 原始数据行数: 53043
2025-06-06 20:06:24,084 - INFO - 删除空值后的行数: 52681
2025-06-06 20:10:03,945 - ERROR - Visualization error: Could not interpret value `text_length` for `x`. An entry with this name does not appear in `data`.
2025-06-06 20:10:03,946 - INFO - Training ML models...
2025-06-06 20:10:03,946 - INFO - Training model: lr
2025-06-06 20:10:04,006 - ERROR - Training error (lr): Parameter grid for parameter 'max_iter' needs to be a list or a numpy array, but got 1000 (of type int) instead. Single values need to be wrapped in a list with one element.
2025-06-06 20:10:04,006 - INFO - Training model: rf
2025-06-06 20:10:04,012 - ERROR - Training error (rf): Parameter grid for parameter 'random_state' needs to be a list or a numpy array, but got 42 (of type int) instead. Single values need to be wrapped in a list with one element.
2025-06-06 20:10:04,012 - INFO - Training model: mlp
2025-06-06 20:10:04,013 - ERROR - Training error (mlp): Parameter grid for parameter 'max_iter' needs to be a list or a numpy array, but got 200 (of type int) instead. Single values need to be wrapped in a list with one element.
2025-06-06 20:10:04,013 - INFO - Training model: svm
2025-06-06 20:10:04,015 - ERROR - Training error (svm): Parameter grid for parameter 'random_state' needs to be a list or a numpy array, but got 42 (of type int) instead. Single values need to be wrapped in a list with one element.
2025-06-06 20:10:04,015 - ERROR - Metric plot error: list index out of range
2025-06-06 20:10:04,015 - INFO - Evaluating LLM baseline...
2025-06-06 20:10:04,015 - ERROR - Pipeline failed: 'numpy.ndarray' object has no attribute 'index'
Traceback (most recent call last):
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/main.py", line 123, in main
    llm_results = evaluate_llm(processor, trainer, viz, df, X_test.index, y_test)
                                                            ^^^^^^^^^^^^
AttributeError: 'numpy.ndarray' object has no attribute 'index'
2025-06-06 20:12:21,572 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 20:12:21,572 - INFO - Directory created or exists: plots
2025-06-06 20:12:21,572 - INFO - Directory created or exists: models
2025-06-06 20:12:21,572 - INFO - Directory created or exists: results
2025-06-06 20:12:21,580 - INFO - Use pytorch device_name: mps
2025-06-06 20:12:21,580 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-06-06 20:12:24,012 - INFO - Processing data...
2025-06-06 20:12:24,210 - INFO - 原始数据行数: 53043
2025-06-06 20:12:24,214 - INFO - 删除空值后的行数: 52681
2025-06-06 20:15:56,772 - INFO - Training ML models...
2025-06-06 20:15:56,773 - INFO - Generating embeddings with: minilm
2025-06-06 20:15:56,776 - INFO - Use pytorch device_name: mps
2025-06-06 20:15:56,776 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-06-06 20:19:44,379 - INFO - Saved embeddings for minilm
2025-06-06 20:19:44,432 - INFO - Training model: lr on embeddings: minilm
2025-06-06 20:22:06,517 - INFO - Saved model minilm_lr
2025-06-06 20:22:07,449 - INFO - Training model: rf on embeddings: minilm
2025-06-06 20:27:52,493 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 20:27:52,493 - INFO - Directory created or exists: plots
2025-06-06 20:27:52,493 - INFO - Directory created or exists: models
2025-06-06 20:27:52,493 - INFO - Directory created or exists: results
2025-06-06 20:27:52,510 - INFO - Use pytorch device_name: mps
2025-06-06 20:27:52,510 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-06-06 20:27:54,442 - INFO - Processing data...
2025-06-06 20:27:54,652 - INFO - 原始数据行数: 53043
2025-06-06 20:27:54,657 - INFO - 删除空值后的行数: 52681
2025-06-06 20:33:51,598 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 20:33:51,598 - INFO - Directory created or exists: plots
2025-06-06 20:33:51,598 - INFO - Directory created or exists: models
2025-06-06 20:33:51,598 - INFO - Directory created or exists: results
2025-06-06 20:33:51,598 - INFO - 
Processing with minilm model...
2025-06-06 20:33:51,607 - INFO - Use pytorch device_name: mps
2025-06-06 20:33:51,607 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-06-06 20:33:53,506 - INFO - Processing data...
2025-06-06 20:33:53,731 - INFO - 原始数据行数: 53043
2025-06-06 20:33:53,735 - INFO - 删除空值后的行数: 52681
2025-06-06 20:33:53,744 - ERROR - Pipeline failed: 'SentenceTransformer' object has no attribute 'get_config_dict'
Traceback (most recent call last):
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/main.py", line 143, in main
    X_train, X_test, y_train, y_test, df = processor.process_data()
                                           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/data_processor.py", line 117, in process_data
    embedding_path = f'models/embeddings_{self.model.get_config_dict()["model_name"]}.npy'
                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1931, in __getattr__
    raise AttributeError(
AttributeError: 'SentenceTransformer' object has no attribute 'get_config_dict'
2025-06-06 20:34:46,624 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 20:34:46,624 - INFO - Directory created or exists: plots
2025-06-06 20:34:46,624 - INFO - Directory created or exists: models
2025-06-06 20:34:46,624 - INFO - Directory created or exists: results
2025-06-06 20:34:46,625 - INFO - 
Processing with minilm model...
2025-06-06 20:34:46,636 - INFO - Use pytorch device_name: mps
2025-06-06 20:34:46,636 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-06-06 20:34:48,400 - INFO - Processing data...
2025-06-06 20:34:48,602 - INFO - 原始数据行数: 53043
2025-06-06 20:34:48,606 - INFO - 删除空值后的行数: 52681
2025-06-06 20:34:48,616 - INFO - Loading existing embeddings for minilm
2025-06-06 20:34:48,883 - ERROR - Visualization error: [Errno 2] No such file or directory: '/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/plots/plots/data_analysis/text_length_distribution.png'
2025-06-06 20:34:48,883 - INFO - Training ML models...
2025-06-06 20:34:48,883 - INFO - Loading existing model lr
2025-06-06 20:34:48,993 - ERROR - Pipeline failed: [Errno 2] No such file or directory: '/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/plots/plots/minilm/lr/confusion_matrix.png'
Traceback (most recent call last):
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/main.py", line 165, in main
    model_results = evaluate_embedding_models(processor, trainer, viz, X_train, X_test, y_train, y_test)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/main.py", line 74, in evaluate_embedding_models
    viz.plot_cm(y_test, metrics['y_pred'], processor.label_map,
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/visualizer.py", line 32, in plot_cm
    self._save_plot(filename)
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/visualizer.py", line 19, in _save_plot
    plt.savefig(os.path.join(self.save_dir, filename), bbox_inches='tight', dpi=300)
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/matplotlib/pyplot.py", line 1243, in savefig
    res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/matplotlib/figure.py", line 3490, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/matplotlib/backend_bases.py", line 2184, in print_figure
    result = print_method(
             ^^^^^^^^^^^^^
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/matplotlib/backend_bases.py", line 2040, in <lambda>
    print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
                                                                 ^^^^^
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/matplotlib/backends/backend_agg.py", line 481, in print_png
    self._print_pil(filename_or_obj, "png", pil_kwargs, metadata)
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/matplotlib/backends/backend_agg.py", line 430, in _print_pil
    mpl.image.imsave(
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/matplotlib/image.py", line 1634, in imsave
    image.save(fname, **pil_kwargs)
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/PIL/Image.py", line 2600, in save
    fp = builtins.open(filename, "w+b")
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/plots/plots/minilm/lr/confusion_matrix.png'
2025-06-06 20:35:40,958 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 20:35:40,959 - INFO - Directory created or exists: plots
2025-06-06 20:35:40,959 - INFO - Directory created or exists: models
2025-06-06 20:35:40,959 - INFO - Directory created or exists: results
2025-06-06 20:35:40,959 - INFO - 
Processing with minilm model...
2025-06-06 20:35:40,967 - INFO - Use pytorch device_name: mps
2025-06-06 20:35:40,967 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-06-06 20:35:42,763 - INFO - Processing data...
2025-06-06 20:35:42,968 - INFO - 原始数据行数: 53043
2025-06-06 20:35:42,972 - INFO - 删除空值后的行数: 52681
2025-06-06 20:35:42,982 - INFO - Loading existing embeddings for minilm
2025-06-06 20:35:49,327 - INFO - Training ML models...
2025-06-06 20:35:49,328 - INFO - Loading existing model lr
2025-06-06 20:35:50,171 - INFO - Training new model: rf
2025-06-06 20:45:23,544 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 20:45:23,544 - INFO - Directory created or exists: plots
2025-06-06 20:45:23,544 - INFO - Directory created or exists: models
2025-06-06 20:45:23,544 - INFO - Directory created or exists: results
2025-06-06 20:45:23,545 - INFO - 
Processing with minilm model...
2025-06-06 20:45:23,555 - INFO - Use pytorch device_name: mps
2025-06-06 20:45:23,555 - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-06-06 20:45:25,658 - INFO - Processing data...
2025-06-06 20:45:25,866 - INFO - 原始数据行数: 53043
2025-06-06 20:45:25,870 - INFO - 删除空值后的行数: 52681
2025-06-06 20:45:25,880 - INFO - Loading existing embeddings for minilm
2025-06-06 20:45:32,220 - INFO - Training ML models...
2025-06-06 20:45:32,220 - INFO - Loading existing model lr
2025-06-06 20:45:33,055 - INFO - Training new model: rf
2025-06-06 20:46:29,211 - INFO - Saved model rf
2025-06-06 20:46:30,205 - INFO - Training new model: mlp
2025-06-06 20:46:30,378 - ERROR - Training error (mlp): Invalid parameter 'n_jobs' for estimator MLPClassifier(early_stopping=True, hidden_layer_sizes=(64,)). Valid parameters are: ['activation', 'alpha', 'batch_size', 'beta_1', 'beta_2', 'early_stopping', 'epsilon', 'hidden_layer_sizes', 'learning_rate', 'learning_rate_init', 'max_fun', 'max_iter', 'momentum', 'n_iter_no_change', 'nesterovs_momentum', 'power_t', 'random_state', 'shuffle', 'solver', 'tol', 'validation_fraction', 'verbose', 'warm_start'].
2025-06-06 20:46:30,378 - INFO - Training new model: svm
2025-06-06 20:50:08,303 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 20:50:08,303 - INFO - Directory created or exists: plots
2025-06-06 20:50:08,303 - INFO - Directory created or exists: models
2025-06-06 20:50:08,303 - INFO - Directory created or exists: results
2025-06-06 20:50:08,304 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 20:50:08,314 - INFO - Use pytorch device_name: mps
2025-06-06 20:50:08,315 - INFO - Load pretrained SentenceTransformer: {'model_name': 'sentence-transformers/all-MiniLM-L6-v2', 'max_length': 128}
2025-06-06 20:50:08,315 - ERROR - Pipeline failed: stat: path should be string, bytes, os.PathLike or integer, not dict
Traceback (most recent call last):
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/main.py", line 160, in main
    processor = DataProcessor(model_name=model_name)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/data_processor.py", line 17, in __init__
    self.model = SentenceTransformer(EMB_MODELS[model_name])
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/sentence_transformers/SentenceTransformer.py", line 293, in __init__
    if not os.path.exists(model_name_or_path):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen genericpath>", line 19, in exists
TypeError: stat: path should be string, bytes, os.PathLike or integer, not dict
2025-06-06 20:50:54,236 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 20:50:54,236 - INFO - Directory created or exists: plots
2025-06-06 20:50:54,236 - INFO - Directory created or exists: models
2025-06-06 20:50:54,236 - INFO - Directory created or exists: results
2025-06-06 20:50:54,236 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 20:50:54,245 - INFO - Use pytorch device_name: mps
2025-06-06 20:50:54,246 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 20:50:56,541 - INFO - Processing data...
2025-06-06 20:50:56,545 - ERROR - Error loading data: [Errno 2] No such file or directory: 'data/mental_health.csv'
2025-06-06 20:50:56,545 - ERROR - Pipeline failed: [Errno 2] No such file or directory: 'data/mental_health.csv'
Traceback (most recent call last):
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/main.py", line 164, in main
    X_train, X_test, y_train, y_test, df = processor.process_data()
                                           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/data_processor.py", line 63, in process_data
    df = self.load_data()
         ^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/data_processor.py", line 24, in load_data
    df = pd.read_csv(filepath)
         ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/Users/gaoyuanji/miniconda3/lib/python3.12/site-packages/pandas/io/common.py", line 873, in get_handle
    handle = open(
             ^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'data/mental_health.csv'
2025-06-06 20:53:29,232 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 20:53:29,232 - INFO - Directory created or exists: plots
2025-06-06 20:53:29,232 - INFO - Directory created or exists: models
2025-06-06 20:53:29,232 - INFO - Directory created or exists: results
2025-06-06 20:53:29,232 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 20:53:29,241 - INFO - Use pytorch device_name: mps
2025-06-06 20:53:29,241 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 20:53:31,253 - INFO - Processing data...
2025-06-06 20:53:31,469 - INFO - Loaded 53043 samples from data/Combined Data.csv
2025-06-06 20:53:31,481 - INFO - Generating embeddings using all-MiniLM-L6-v2
2025-06-06 20:59:08,972 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 20:59:08,972 - INFO - Directory created or exists: plots
2025-06-06 20:59:08,972 - INFO - Directory created or exists: models
2025-06-06 20:59:08,972 - INFO - Directory created or exists: results
2025-06-06 20:59:08,973 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 20:59:08,982 - INFO - Use pytorch device_name: mps
2025-06-06 20:59:08,982 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 20:59:11,046 - INFO - Processing data...
2025-06-06 20:59:11,255 - INFO - Loaded 53043 samples from data/Combined Data.csv
2025-06-06 20:59:11,265 - INFO - Generating embeddings using all-MiniLM-L6-v2
2025-06-06 21:01:06,925 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 21:01:06,926 - INFO - Directory created or exists: plots
2025-06-06 21:01:06,926 - INFO - Directory created or exists: models
2025-06-06 21:01:06,926 - INFO - Directory created or exists: results
2025-06-06 21:01:06,926 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 21:01:06,936 - INFO - Use pytorch device_name: mps
2025-06-06 21:01:06,936 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 21:01:09,105 - INFO - Processing data...
2025-06-06 21:01:09,329 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 21:01:09,339 - INFO - Generating embeddings using all-MiniLM-L6-v2
2025-06-06 21:04:39,234 - INFO - Saved embeddings to models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 21:04:46,193 - INFO - Training ML models...
2025-06-06 21:04:46,194 - INFO - Training new model: lr
2025-06-06 21:04:46,229 - ERROR - Training error (lr): Parameter grid for parameter 'n_jobs' needs to be a list or a numpy array, but got -1 (of type int) instead. Single values need to be wrapped in a list with one element.
2025-06-06 21:04:46,230 - INFO - Training new model: rf
2025-06-06 21:04:46,232 - ERROR - Training error (rf): Parameter grid for parameter 'n_jobs' needs to be a list or a numpy array, but got -1 (of type int) instead. Single values need to be wrapped in a list with one element.
2025-06-06 21:04:46,232 - INFO - Training new model: mlp
2025-06-06 21:05:09,995 - INFO - Saved model mlp
2025-06-06 21:05:11,403 - INFO - Training new model: svm
2025-06-06 21:05:11,404 - ERROR - Training error (svm): Parameter grid for parameter 'n_jobs' needs to be a list or a numpy array, but got -1 (of type int) instead. Single values need to be wrapped in a list with one element.
2025-06-06 21:05:11,416 - ERROR - Metric plot error: only length-1 arrays can be converted to Python scalars
2025-06-06 21:05:11,416 - INFO - 
Processing with all-mpnet-base-v2 model...
2025-06-06 21:05:11,418 - INFO - Use pytorch device_name: mps
2025-06-06 21:05:11,418 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-mpnet-base-v2
2025-06-06 21:05:23,708 - INFO - Processing data...
2025-06-06 21:05:23,968 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 21:05:23,978 - INFO - Generating embeddings using all-mpnet-base-v2
2025-06-06 21:09:48,385 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 21:09:48,385 - INFO - Directory created or exists: plots
2025-06-06 21:09:48,385 - INFO - Directory created or exists: models
2025-06-06 21:09:48,385 - INFO - Directory created or exists: results
2025-06-06 21:09:48,385 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 21:09:48,402 - INFO - Use pytorch device_name: mps
2025-06-06 21:09:48,403 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 21:09:50,249 - INFO - Processing data...
2025-06-06 21:09:50,465 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 21:09:50,476 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 21:09:56,828 - INFO - Training ML models...
2025-06-06 21:09:56,828 - INFO - Training new model: lr
2025-06-06 21:10:27,930 - INFO - Saved model lr
2025-06-06 21:10:28,849 - INFO - Training new model: rf
2025-06-06 21:11:28,225 - INFO - Saved model rf
2025-06-06 21:11:29,136 - INFO - Loading existing model mlp
2025-06-06 21:11:29,961 - INFO - Training new model: svm
2025-06-06 21:11:30,096 - ERROR - Training error (svm): Invalid parameter 'n_jobs' for estimator SVC(C=0.1, probability=True, random_state=42). Valid parameters are: ['C', 'break_ties', 'cache_size', 'class_weight', 'coef0', 'decision_function_shape', 'degree', 'gamma', 'kernel', 'max_iter', 'probability', 'random_state', 'shrinking', 'tol', 'verbose'].
2025-06-06 21:11:30,107 - ERROR - Metric plot error: shape mismatch: objects cannot be broadcast to a single shape.  Mismatch is between arg 0 with shape (3,) and arg 1 with shape (3, 10537).
2025-06-06 21:11:30,107 - INFO - 
Processing with all-mpnet-base-v2 model...
2025-06-06 21:11:30,110 - INFO - Use pytorch device_name: mps
2025-06-06 21:11:30,110 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-mpnet-base-v2
2025-06-06 21:11:32,063 - INFO - Processing data...
2025-06-06 21:11:32,267 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 21:11:32,276 - INFO - Generating embeddings using all-mpnet-base-v2
2025-06-06 21:13:55,717 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 21:13:55,718 - INFO - Directory created or exists: plots
2025-06-06 21:13:55,718 - INFO - Directory created or exists: models
2025-06-06 21:13:55,718 - INFO - Directory created or exists: results
2025-06-06 21:13:55,718 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 21:13:55,728 - INFO - Use pytorch device_name: mps
2025-06-06 21:13:55,728 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 21:13:57,974 - INFO - Processing data...
2025-06-06 21:13:58,186 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 21:13:58,196 - INFO - Mental health status distribution in dataset:
2025-06-06 21:13:58,197 - INFO - Normal: 16343 samples
2025-06-06 21:13:58,197 - INFO - Depression: 15404 samples
2025-06-06 21:13:58,197 - INFO - Suicidal: 10652 samples
2025-06-06 21:13:58,197 - INFO - Anxiety: 3841 samples
2025-06-06 21:13:58,197 - INFO - Bipolar: 2777 samples
2025-06-06 21:13:58,197 - INFO - Stress: 2587 samples
2025-06-06 21:13:58,197 - INFO - Personality disorder: 1077 samples
2025-06-06 21:13:58,197 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 21:13:58,199 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 21:14:04,500 - INFO - Training ML models...
2025-06-06 21:14:04,501 - INFO - Loading existing model lr
2025-06-06 21:14:05,336 - INFO - Loading existing model rf
2025-06-06 21:14:06,181 - INFO - Loading existing model mlp
2025-06-06 21:14:07,006 - INFO - Training new model: svm
2025-06-06 21:14:08,824 - ERROR - Training error (svm): Invalid parameter 'n_jobs' for estimator SVC(C=0.1, probability=True, random_state=42). Valid parameters are: ['C', 'break_ties', 'cache_size', 'class_weight', 'coef0', 'decision_function_shape', 'degree', 'gamma', 'kernel', 'max_iter', 'probability', 'random_state', 'shrinking', 'tol', 'verbose'].
2025-06-06 21:14:08,836 - ERROR - Metric plot error: shape mismatch: objects cannot be broadcast to a single shape.  Mismatch is between arg 0 with shape (3,) and arg 1 with shape (3, 10537).
2025-06-06 21:14:08,837 - INFO - 
Processing with all-mpnet-base-v2 model...
2025-06-06 21:14:08,839 - INFO - Use pytorch device_name: mps
2025-06-06 21:14:08,839 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-mpnet-base-v2
2025-06-06 21:14:10,870 - INFO - Processing data...
2025-06-06 21:14:11,083 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 21:14:11,091 - INFO - Mental health status distribution in dataset:
2025-06-06 21:14:11,091 - INFO - Normal: 16343 samples
2025-06-06 21:14:11,091 - INFO - Depression: 15404 samples
2025-06-06 21:14:11,091 - INFO - Suicidal: 10652 samples
2025-06-06 21:14:11,091 - INFO - Anxiety: 3841 samples
2025-06-06 21:14:11,091 - INFO - Bipolar: 2777 samples
2025-06-06 21:14:11,091 - INFO - Stress: 2587 samples
2025-06-06 21:14:11,091 - INFO - Personality disorder: 1077 samples
2025-06-06 21:14:11,091 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 21:14:11,093 - INFO - Generating embeddings using all-mpnet-base-v2
2025-06-06 21:15:52,752 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 21:15:52,752 - INFO - Directory created or exists: plots
2025-06-06 21:15:52,752 - INFO - Directory created or exists: models
2025-06-06 21:15:52,752 - INFO - Directory created or exists: results
2025-06-06 21:15:52,753 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 21:15:52,764 - INFO - Use pytorch device_name: mps
2025-06-06 21:15:52,764 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 21:15:54,812 - INFO - Processing data...
2025-06-06 21:15:55,034 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 21:15:55,045 - INFO - Mental health status distribution in dataset:
2025-06-06 21:15:55,045 - INFO - Normal: 16343 samples
2025-06-06 21:15:55,045 - INFO - Depression: 15404 samples
2025-06-06 21:15:55,045 - INFO - Suicidal: 10652 samples
2025-06-06 21:15:55,045 - INFO - Anxiety: 3841 samples
2025-06-06 21:15:55,045 - INFO - Bipolar: 2777 samples
2025-06-06 21:15:55,045 - INFO - Stress: 2587 samples
2025-06-06 21:15:55,045 - INFO - Personality disorder: 1077 samples
2025-06-06 21:15:55,045 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 21:15:55,049 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 21:16:01,444 - INFO - Training ML models...
2025-06-06 21:16:01,445 - INFO - Loading existing model lr
2025-06-06 21:16:01,462 - INFO - 
Classification Report:
2025-06-06 21:16:01,465 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.80      0.77      0.79       768
             Bipolar       0.83      0.76      0.79       556
          Depression       0.69      0.74      0.72      3081
              Normal       0.89      0.93      0.91      3269
Personality disorder       0.73      0.53      0.61       215
              Stress       0.62      0.54      0.58       517
            Suicidal       0.67      0.62      0.64      2131

            accuracy                           0.76     10537
           macro avg       0.75      0.70      0.72     10537
        weighted avg       0.76      0.76      0.76     10537

2025-06-06 21:16:01,465 - INFO - Accuracy: 0.7646
2025-06-06 21:16:01,465 - INFO - Weighted Precision: 0.7617
2025-06-06 21:16:01,465 - INFO - Weighted Recall: 0.7646
2025-06-06 21:16:01,465 - INFO - Weighted F1 Score: 0.7619
2025-06-06 21:16:01,613 - ERROR - Pipeline failed: 'fpr'
Traceback (most recent call last):
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/main.py", line 186, in main
    model_results = evaluate_embedding_models(processor, trainer, viz, X_train, X_test, y_train, y_test)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/main.py", line 99, in evaluate_embedding_models
    viz.plot_roc_curve(metrics['fpr'][label], metrics['tpr'][label],
                       ~~~~~~~^^^^^^^
KeyError: 'fpr'
2025-06-06 21:16:53,874 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 21:16:53,874 - INFO - Directory created or exists: plots
2025-06-06 21:16:53,874 - INFO - Directory created or exists: models
2025-06-06 21:16:53,874 - INFO - Directory created or exists: results
2025-06-06 21:16:53,874 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 21:16:53,882 - INFO - Use pytorch device_name: mps
2025-06-06 21:16:53,882 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 21:16:56,258 - INFO - Processing data...
2025-06-06 21:16:56,470 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 21:16:56,481 - INFO - Mental health status distribution in dataset:
2025-06-06 21:16:56,481 - INFO - Normal: 16343 samples
2025-06-06 21:16:56,481 - INFO - Depression: 15404 samples
2025-06-06 21:16:56,481 - INFO - Suicidal: 10652 samples
2025-06-06 21:16:56,481 - INFO - Anxiety: 3841 samples
2025-06-06 21:16:56,481 - INFO - Bipolar: 2777 samples
2025-06-06 21:16:56,481 - INFO - Stress: 2587 samples
2025-06-06 21:16:56,481 - INFO - Personality disorder: 1077 samples
2025-06-06 21:16:56,481 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 21:16:56,483 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 21:17:02,850 - INFO - Training ML models...
2025-06-06 21:17:02,851 - INFO - Loading existing model lr
2025-06-06 21:17:02,868 - INFO - 
Classification Report:
2025-06-06 21:17:02,871 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.80      0.77      0.79       768
             Bipolar       0.83      0.76      0.79       556
          Depression       0.69      0.74      0.72      3081
              Normal       0.89      0.93      0.91      3269
Personality disorder       0.73      0.53      0.61       215
              Stress       0.62      0.54      0.58       517
            Suicidal       0.67      0.62      0.64      2131

            accuracy                           0.76     10537
           macro avg       0.75      0.70      0.72     10537
        weighted avg       0.76      0.76      0.76     10537

2025-06-06 21:17:02,871 - INFO - Accuracy: 0.7646
2025-06-06 21:17:02,871 - INFO - Weighted Precision: 0.7617
2025-06-06 21:17:02,871 - INFO - Weighted Recall: 0.7646
2025-06-06 21:17:02,871 - INFO - Weighted F1 Score: 0.7619
2025-06-06 21:17:03,017 - INFO - Loading existing model rf
2025-06-06 21:17:03,046 - INFO - 
Classification Report:
2025-06-06 21:17:03,050 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.82      0.50      0.62       768
             Bipolar       0.96      0.28      0.43       556
          Depression       0.54      0.80      0.64      3081
              Normal       0.77      0.96      0.86      3269
Personality disorder       1.00      0.01      0.02       215
              Stress       1.00      0.03      0.07       517
            Suicidal       0.70      0.39      0.50      2131

            accuracy                           0.67     10537
           macro avg       0.83      0.43      0.45     10537
        weighted avg       0.72      0.67      0.63     10537

2025-06-06 21:17:03,050 - INFO - Accuracy: 0.6657
2025-06-06 21:17:03,050 - INFO - Weighted Precision: 0.7172
2025-06-06 21:17:03,050 - INFO - Weighted Recall: 0.6657
2025-06-06 21:17:03,050 - INFO - Weighted F1 Score: 0.6270
2025-06-06 21:17:03,192 - INFO - Loading existing model mlp
2025-06-06 21:17:03,206 - INFO - 
Classification Report:
2025-06-06 21:17:03,210 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.81      0.79      0.80       768
             Bipolar       0.80      0.77      0.78       556
          Depression       0.71      0.75      0.73      3081
              Normal       0.91      0.94      0.92      3269
Personality disorder       0.71      0.56      0.63       215
              Stress       0.65      0.55      0.60       517
            Suicidal       0.68      0.64      0.66      2131

            accuracy                           0.78     10537
           macro avg       0.75      0.71      0.73     10537
        weighted avg       0.77      0.78      0.78     10537

2025-06-06 21:17:03,210 - INFO - Accuracy: 0.7772
2025-06-06 21:17:03,210 - INFO - Weighted Precision: 0.7750
2025-06-06 21:17:03,210 - INFO - Weighted Recall: 0.7772
2025-06-06 21:17:03,210 - INFO - Weighted F1 Score: 0.7752
2025-06-06 21:17:03,354 - INFO - Training new model: svm
2025-06-06 21:17:04,865 - ERROR - Training error (svm): Invalid parameter 'n_jobs' for estimator SVC(C=0.1, probability=True, random_state=42). Valid parameters are: ['C', 'break_ties', 'cache_size', 'class_weight', 'coef0', 'decision_function_shape', 'degree', 'gamma', 'kernel', 'max_iter', 'probability', 'random_state', 'shrinking', 'tol', 'verbose'].
2025-06-06 21:17:04,877 - ERROR - Metric plot error: shape mismatch: objects cannot be broadcast to a single shape.  Mismatch is between arg 0 with shape (3,) and arg 1 with shape (3, 10537).
2025-06-06 21:17:04,877 - INFO - 
Processing with all-mpnet-base-v2 model...
2025-06-06 21:17:04,879 - INFO - Use pytorch device_name: mps
2025-06-06 21:17:04,879 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-mpnet-base-v2
2025-06-06 21:17:07,198 - INFO - Processing data...
2025-06-06 21:17:07,416 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 21:17:07,425 - INFO - Mental health status distribution in dataset:
2025-06-06 21:17:07,425 - INFO - Normal: 16343 samples
2025-06-06 21:17:07,425 - INFO - Depression: 15404 samples
2025-06-06 21:17:07,425 - INFO - Suicidal: 10652 samples
2025-06-06 21:17:07,425 - INFO - Anxiety: 3841 samples
2025-06-06 21:17:07,425 - INFO - Bipolar: 2777 samples
2025-06-06 21:17:07,425 - INFO - Stress: 2587 samples
2025-06-06 21:17:07,425 - INFO - Personality disorder: 1077 samples
2025-06-06 21:17:07,425 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 21:17:07,426 - INFO - Generating embeddings using all-mpnet-base-v2
2025-06-06 21:18:30,233 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 21:18:30,233 - INFO - Directory created or exists: plots
2025-06-06 21:18:30,233 - INFO - Directory created or exists: models
2025-06-06 21:18:30,233 - INFO - Directory created or exists: results
2025-06-06 21:18:30,234 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 21:18:30,248 - INFO - Use pytorch device_name: mps
2025-06-06 21:18:30,248 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 21:18:32,304 - INFO - Processing data...
2025-06-06 21:18:32,520 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 21:18:32,531 - INFO - Mental health status distribution in dataset:
2025-06-06 21:18:32,532 - INFO - Normal: 16343 samples
2025-06-06 21:18:32,532 - INFO - Depression: 15404 samples
2025-06-06 21:18:32,532 - INFO - Suicidal: 10652 samples
2025-06-06 21:18:32,532 - INFO - Anxiety: 3841 samples
2025-06-06 21:18:32,532 - INFO - Bipolar: 2777 samples
2025-06-06 21:18:32,532 - INFO - Stress: 2587 samples
2025-06-06 21:18:32,532 - INFO - Personality disorder: 1077 samples
2025-06-06 21:18:32,532 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 21:18:32,533 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 21:18:39,055 - INFO - Training ML models...
2025-06-06 21:18:39,056 - INFO - Loading existing model lr
2025-06-06 21:18:39,073 - INFO - 
Classification Report:
2025-06-06 21:18:39,077 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.80      0.77      0.79       768
             Bipolar       0.83      0.76      0.79       556
          Depression       0.69      0.74      0.72      3081
              Normal       0.89      0.93      0.91      3269
Personality disorder       0.73      0.53      0.61       215
              Stress       0.62      0.54      0.58       517
            Suicidal       0.67      0.62      0.64      2131

            accuracy                           0.76     10537
           macro avg       0.75      0.70      0.72     10537
        weighted avg       0.76      0.76      0.76     10537

2025-06-06 21:18:39,077 - INFO - Accuracy: 0.7646
2025-06-06 21:18:39,077 - INFO - Weighted Precision: 0.7617
2025-06-06 21:18:39,077 - INFO - Weighted Recall: 0.7646
2025-06-06 21:18:39,077 - INFO - Weighted F1 Score: 0.7619
2025-06-06 21:18:39,227 - INFO - Loading existing model rf
2025-06-06 21:18:39,257 - INFO - 
Classification Report:
2025-06-06 21:18:39,261 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.82      0.50      0.62       768
             Bipolar       0.96      0.28      0.43       556
          Depression       0.54      0.80      0.64      3081
              Normal       0.77      0.96      0.86      3269
Personality disorder       1.00      0.01      0.02       215
              Stress       1.00      0.03      0.07       517
            Suicidal       0.70      0.39      0.50      2131

            accuracy                           0.67     10537
           macro avg       0.83      0.43      0.45     10537
        weighted avg       0.72      0.67      0.63     10537

2025-06-06 21:18:39,261 - INFO - Accuracy: 0.6657
2025-06-06 21:18:39,261 - INFO - Weighted Precision: 0.7172
2025-06-06 21:18:39,261 - INFO - Weighted Recall: 0.6657
2025-06-06 21:18:39,261 - INFO - Weighted F1 Score: 0.6270
2025-06-06 21:18:39,405 - INFO - Loading existing model mlp
2025-06-06 21:18:39,417 - INFO - 
Classification Report:
2025-06-06 21:18:39,420 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.81      0.79      0.80       768
             Bipolar       0.80      0.77      0.78       556
          Depression       0.71      0.75      0.73      3081
              Normal       0.91      0.94      0.92      3269
Personality disorder       0.71      0.56      0.63       215
              Stress       0.65      0.55      0.60       517
            Suicidal       0.68      0.64      0.66      2131

            accuracy                           0.78     10537
           macro avg       0.75      0.71      0.73     10537
        weighted avg       0.77      0.78      0.78     10537

2025-06-06 21:18:39,420 - INFO - Accuracy: 0.7772
2025-06-06 21:18:39,420 - INFO - Weighted Precision: 0.7750
2025-06-06 21:18:39,421 - INFO - Weighted Recall: 0.7772
2025-06-06 21:18:39,421 - INFO - Weighted F1 Score: 0.7752
2025-06-06 21:18:39,568 - INFO - Training new model: svm
2025-06-06 21:35:18,457 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 21:35:18,457 - INFO - Directory created or exists: plots
2025-06-06 21:35:18,457 - INFO - Directory created or exists: models
2025-06-06 21:35:18,457 - INFO - Directory created or exists: results
2025-06-06 21:35:18,458 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 21:35:18,471 - INFO - Use pytorch device_name: mps
2025-06-06 21:35:18,471 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 21:35:20,694 - INFO - Processing data...
2025-06-06 21:35:20,929 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 21:35:20,940 - INFO - Mental health status distribution in dataset:
2025-06-06 21:35:20,940 - INFO - Normal: 16343 samples
2025-06-06 21:35:20,940 - INFO - Depression: 15404 samples
2025-06-06 21:35:20,940 - INFO - Suicidal: 10652 samples
2025-06-06 21:35:20,940 - INFO - Anxiety: 3841 samples
2025-06-06 21:35:20,940 - INFO - Bipolar: 2777 samples
2025-06-06 21:35:20,940 - INFO - Stress: 2587 samples
2025-06-06 21:35:20,940 - INFO - Personality disorder: 1077 samples
2025-06-06 21:35:20,940 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 21:35:20,942 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 21:35:27,413 - INFO - Training ML models...
2025-06-06 21:35:27,414 - INFO - Loading existing model lr
2025-06-06 21:35:27,431 - INFO - 
Classification Report:
2025-06-06 21:35:27,435 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.62      0.82      0.70       768
             Bipolar       0.43      0.84      0.57       556
          Depression       0.82      0.39      0.53      3081
              Normal       0.89      0.90      0.90      3269
Personality disorder       0.17      0.79      0.28       215
              Stress       0.38      0.67      0.48       517
            Suicidal       0.68      0.56      0.61      2131

            accuracy                           0.66     10537
           macro avg       0.57      0.71      0.58     10537
        weighted avg       0.74      0.66      0.67     10537

2025-06-06 21:35:27,435 - INFO - Accuracy: 0.6594
2025-06-06 21:35:27,435 - INFO - Weighted Precision: 0.7430
2025-06-06 21:35:27,435 - INFO - Weighted Recall: 0.6594
2025-06-06 21:35:27,435 - INFO - Weighted F1 Score: 0.6665
2025-06-06 21:35:27,587 - INFO - Loading existing model rf
2025-06-06 21:35:27,629 - INFO - 
Classification Report:
2025-06-06 21:35:27,633 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.68      0.58      0.63       768
             Bipolar       0.90      0.33      0.48       556
          Depression       0.55      0.70      0.62      3081
              Normal       0.73      0.94      0.82      3269
Personality disorder       1.00      0.01      0.02       215
              Stress       0.70      0.06      0.11       517
            Suicidal       0.56      0.40      0.46      2131

            accuracy                           0.64     10537
           macro avg       0.73      0.43      0.45     10537
        weighted avg       0.65      0.64      0.60     10537

2025-06-06 21:35:27,633 - INFO - Accuracy: 0.6382
2025-06-06 21:35:27,633 - INFO - Weighted Precision: 0.6515
2025-06-06 21:35:27,633 - INFO - Weighted Recall: 0.6382
2025-06-06 21:35:27,633 - INFO - Weighted F1 Score: 0.6050
2025-06-06 21:35:27,777 - INFO - Loading existing model mlp
2025-06-06 21:35:27,789 - INFO - 
Classification Report:
2025-06-06 21:35:27,793 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.71      0.78      0.74       768
             Bipolar       0.63      0.79      0.70       556
          Depression       0.74      0.61      0.67      3081
              Normal       0.78      0.97      0.87      3269
Personality disorder       0.40      0.62      0.49       215
              Stress       0.43      0.61      0.50       517
            Suicidal       0.73      0.45      0.56      2131

            accuracy                           0.71     10537
           macro avg       0.63      0.69      0.65     10537
        weighted avg       0.72      0.71      0.70     10537

2025-06-06 21:35:27,793 - INFO - Accuracy: 0.7137
2025-06-06 21:35:27,793 - INFO - Weighted Precision: 0.7210
2025-06-06 21:35:27,793 - INFO - Weighted Recall: 0.7137
2025-06-06 21:35:27,793 - INFO - Weighted F1 Score: 0.7042
2025-06-06 21:35:27,945 - INFO - Training new model: svm
2025-06-06 21:36:04,023 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 21:36:04,023 - INFO - Directory created or exists: plots
2025-06-06 21:36:04,024 - INFO - Directory created or exists: models
2025-06-06 21:36:04,024 - INFO - Directory created or exists: results
2025-06-06 21:36:04,024 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 21:36:04,033 - INFO - Use pytorch device_name: mps
2025-06-06 21:36:04,033 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 21:36:05,885 - INFO - Processing data...
2025-06-06 21:36:06,114 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 21:36:06,125 - INFO - Mental health status distribution in dataset:
2025-06-06 21:36:06,125 - INFO - Normal: 16343 samples
2025-06-06 21:36:06,125 - INFO - Depression: 15404 samples
2025-06-06 21:36:06,125 - INFO - Suicidal: 10652 samples
2025-06-06 21:36:06,126 - INFO - Anxiety: 3841 samples
2025-06-06 21:36:06,126 - INFO - Bipolar: 2777 samples
2025-06-06 21:36:06,126 - INFO - Stress: 2587 samples
2025-06-06 21:36:06,126 - INFO - Personality disorder: 1077 samples
2025-06-06 21:36:06,127 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 21:36:06,129 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 21:36:12,604 - INFO - Training ML models...
2025-06-06 21:36:12,605 - INFO - Training new model: lr
2025-06-06 21:36:40,191 - INFO - 
Classification Report:
2025-06-06 21:36:40,195 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.81      0.77      0.79       768
             Bipolar       0.81      0.76      0.78       556
          Depression       0.70      0.75      0.72      3081
              Normal       0.89      0.93      0.91      3269
Personality disorder       0.71      0.53      0.61       215
              Stress       0.63      0.56      0.59       517
            Suicidal       0.68      0.62      0.65      2131

            accuracy                           0.77     10537
           macro avg       0.75      0.70      0.72     10537
        weighted avg       0.77      0.77      0.77     10537

2025-06-06 21:36:40,195 - INFO - Accuracy: 0.7676
2025-06-06 21:36:40,195 - INFO - Weighted Precision: 0.7651
2025-06-06 21:36:40,195 - INFO - Weighted Recall: 0.7676
2025-06-06 21:36:40,195 - INFO - Weighted F1 Score: 0.7652
2025-06-06 21:36:40,197 - INFO - Saved model lr
2025-06-06 21:36:40,470 - INFO - Training new model: rf
2025-06-06 21:37:40,695 - INFO - 
Classification Report:
2025-06-06 21:37:40,700 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.82      0.50      0.62       768
             Bipolar       0.96      0.28      0.43       556
          Depression       0.54      0.80      0.64      3081
              Normal       0.77      0.96      0.86      3269
Personality disorder       1.00      0.01      0.02       215
              Stress       1.00      0.03      0.07       517
            Suicidal       0.70      0.39      0.50      2131

            accuracy                           0.67     10537
           macro avg       0.83      0.43      0.45     10537
        weighted avg       0.72      0.67      0.63     10537

2025-06-06 21:37:40,700 - INFO - Accuracy: 0.6657
2025-06-06 21:37:40,700 - INFO - Weighted Precision: 0.7172
2025-06-06 21:37:40,700 - INFO - Weighted Recall: 0.6657
2025-06-06 21:37:40,700 - INFO - Weighted F1 Score: 0.6270
2025-06-06 21:37:40,714 - INFO - Saved model rf
2025-06-06 21:37:40,993 - INFO - Training new model: mlp
2025-06-06 21:37:50,846 - INFO - 
Classification Report:
2025-06-06 21:37:50,851 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.82      0.77      0.79       768
             Bipolar       0.83      0.75      0.79       556
          Depression       0.71      0.74      0.73      3081
              Normal       0.91      0.94      0.92      3269
Personality disorder       0.72      0.57      0.64       215
              Stress       0.60      0.60      0.60       517
            Suicidal       0.67      0.65      0.66      2131

            accuracy                           0.77     10537
           macro avg       0.75      0.72      0.73     10537
        weighted avg       0.77      0.77      0.77     10537

2025-06-06 21:37:50,851 - INFO - Accuracy: 0.7738
2025-06-06 21:37:50,851 - INFO - Weighted Precision: 0.7726
2025-06-06 21:37:50,851 - INFO - Weighted Recall: 0.7738
2025-06-06 21:37:50,851 - INFO - Weighted F1 Score: 0.7727
2025-06-06 21:37:50,853 - INFO - Saved model mlp
2025-06-06 21:37:51,130 - INFO - Training new model: svm
2025-06-06 21:49:39,286 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 21:49:39,287 - INFO - Directory created or exists: plots
2025-06-06 21:49:39,287 - INFO - Directory created or exists: models
2025-06-06 21:49:39,287 - INFO - Directory created or exists: results
2025-06-06 21:49:39,287 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 21:49:39,299 - INFO - Use pytorch device_name: mps
2025-06-06 21:49:39,299 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 21:49:41,310 - INFO - Processing data...
2025-06-06 21:49:41,527 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 21:49:41,541 - INFO - Mental health status distribution in dataset:
2025-06-06 21:49:41,541 - INFO - Normal: 16343 samples
2025-06-06 21:49:41,541 - INFO - Depression: 15404 samples
2025-06-06 21:49:41,541 - INFO - Suicidal: 10652 samples
2025-06-06 21:49:41,541 - INFO - Anxiety: 3841 samples
2025-06-06 21:49:41,541 - INFO - Bipolar: 2777 samples
2025-06-06 21:49:41,541 - INFO - Stress: 2587 samples
2025-06-06 21:49:41,541 - INFO - Personality disorder: 1077 samples
2025-06-06 21:49:41,541 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 21:49:41,543 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 21:49:47,986 - INFO - Training ML models...
2025-06-06 21:49:47,986 - INFO - Loading existing model lr
2025-06-06 21:49:48,004 - INFO - 
Classification Report:
2025-06-06 21:49:48,008 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.81      0.77      0.79       768
             Bipolar       0.81      0.76      0.78       556
          Depression       0.70      0.75      0.72      3081
              Normal       0.89      0.93      0.91      3269
Personality disorder       0.71      0.53      0.61       215
              Stress       0.63      0.56      0.59       517
            Suicidal       0.68      0.62      0.65      2131

            accuracy                           0.77     10537
           macro avg       0.75      0.70      0.72     10537
        weighted avg       0.77      0.77      0.77     10537

2025-06-06 21:49:48,008 - INFO - Accuracy: 0.7676
2025-06-06 21:49:48,008 - INFO - Weighted Precision: 0.7651
2025-06-06 21:49:48,008 - INFO - Weighted Recall: 0.7676
2025-06-06 21:49:48,008 - INFO - Weighted F1 Score: 0.7652
2025-06-06 21:49:48,154 - INFO - Loading existing model rf
2025-06-06 21:49:48,186 - INFO - 
Classification Report:
2025-06-06 21:49:48,190 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.82      0.50      0.62       768
             Bipolar       0.96      0.28      0.43       556
          Depression       0.54      0.80      0.64      3081
              Normal       0.77      0.96      0.86      3269
Personality disorder       1.00      0.01      0.02       215
              Stress       1.00      0.03      0.07       517
            Suicidal       0.70      0.39      0.50      2131

            accuracy                           0.67     10537
           macro avg       0.83      0.43      0.45     10537
        weighted avg       0.72      0.67      0.63     10537

2025-06-06 21:49:48,190 - INFO - Accuracy: 0.6657
2025-06-06 21:49:48,190 - INFO - Weighted Precision: 0.7172
2025-06-06 21:49:48,190 - INFO - Weighted Recall: 0.6657
2025-06-06 21:49:48,190 - INFO - Weighted F1 Score: 0.6270
2025-06-06 21:49:48,334 - INFO - Loading existing model mlp
2025-06-06 21:49:48,346 - INFO - 
Classification Report:
2025-06-06 21:49:48,349 - INFO -                       precision    recall  f1-score   support

             Anxiety       0.82      0.77      0.79       768
             Bipolar       0.83      0.75      0.79       556
          Depression       0.71      0.74      0.73      3081
              Normal       0.91      0.94      0.92      3269
Personality disorder       0.72      0.57      0.64       215
              Stress       0.60      0.60      0.60       517
            Suicidal       0.67      0.65      0.66      2131

            accuracy                           0.77     10537
           macro avg       0.75      0.72      0.73     10537
        weighted avg       0.77      0.77      0.77     10537

2025-06-06 21:49:48,349 - INFO - Accuracy: 0.7738
2025-06-06 21:49:48,349 - INFO - Weighted Precision: 0.7726
2025-06-06 21:49:48,349 - INFO - Weighted Recall: 0.7738
2025-06-06 21:49:48,349 - INFO - Weighted F1 Score: 0.7727
2025-06-06 21:49:48,493 - INFO - Training new model: svm
2025-06-06 22:13:22,627 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 22:13:22,627 - INFO - Directory created or exists: plots
2025-06-06 22:13:22,627 - INFO - Directory created or exists: models
2025-06-06 22:13:22,627 - INFO - Directory created or exists: results
2025-06-06 22:13:22,627 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 22:13:22,647 - INFO - Use pytorch device_name: mps
2025-06-06 22:13:22,647 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 22:13:24,552 - INFO - Processing data...
2025-06-06 22:13:24,778 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 22:13:24,789 - INFO - Mental health status distribution in dataset:
2025-06-06 22:13:24,789 - INFO - Normal: 16343 samples
2025-06-06 22:13:24,789 - INFO - Depression: 15404 samples
2025-06-06 22:13:24,789 - INFO - Suicidal: 10652 samples
2025-06-06 22:13:24,789 - INFO - Anxiety: 3841 samples
2025-06-06 22:13:24,789 - INFO - Bipolar: 2777 samples
2025-06-06 22:13:24,789 - INFO - Stress: 2587 samples
2025-06-06 22:13:24,789 - INFO - Personality disorder: 1077 samples
2025-06-06 22:13:24,789 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 22:13:24,791 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 22:13:31,284 - INFO - Training ML models...
2025-06-06 22:13:31,285 - INFO - Loading existing model lr
2025-06-06 22:13:31,286 - ERROR - Model evaluation error: unhashable type: 'dict'
2025-06-06 22:13:31,286 - ERROR - Pipeline failed: unhashable type: 'dict'
Traceback (most recent call last):
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/main.py", line 178, in main
    model_results = evaluate_embedding_models(processor, trainer, viz, X_train, X_test, y_train, y_test)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/main.py", line 68, in evaluate_embedding_models
    metrics = trainer.eval(trainer.best_models[algo], X_test, y_test, processor.label_map)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/model_trainer.py", line 74, in eval
    best_model = self.models[algo].best_estimator_
                 ~~~~~~~~~~~^^^^^^
TypeError: unhashable type: 'dict'
2025-06-06 22:14:05,624 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 22:14:05,624 - INFO - Directory created or exists: plots
2025-06-06 22:14:05,624 - INFO - Directory created or exists: models
2025-06-06 22:14:05,624 - INFO - Directory created or exists: results
2025-06-06 22:14:05,625 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 22:14:05,634 - INFO - Use pytorch device_name: mps
2025-06-06 22:14:05,634 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 22:14:07,986 - INFO - Processing data...
2025-06-06 22:14:08,222 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 22:14:08,232 - INFO - Mental health status distribution in dataset:
2025-06-06 22:14:08,233 - INFO - Normal: 16343 samples
2025-06-06 22:14:08,233 - INFO - Depression: 15404 samples
2025-06-06 22:14:08,233 - INFO - Suicidal: 10652 samples
2025-06-06 22:14:08,233 - INFO - Anxiety: 3841 samples
2025-06-06 22:14:08,233 - INFO - Bipolar: 2777 samples
2025-06-06 22:14:08,233 - INFO - Stress: 2587 samples
2025-06-06 22:14:08,233 - INFO - Personality disorder: 1077 samples
2025-06-06 22:14:08,233 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 22:14:08,235 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 22:14:14,722 - INFO - Training ML models...
2025-06-06 22:14:14,724 - INFO - Loading existing model lr
2025-06-06 22:14:14,725 - ERROR - Model evaluation error: unhashable type: 'dict'
2025-06-06 22:14:14,725 - ERROR - Pipeline failed: unhashable type: 'dict'
Traceback (most recent call last):
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/main.py", line 178, in main
    model_results = evaluate_embedding_models(processor, trainer, viz, X_train, X_test, y_train, y_test)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/main.py", line 68, in evaluate_embedding_models
    metrics = trainer.eval(trainer.best_models[algo], X_test, y_test, processor.label_map)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/model_trainer.py", line 74, in eval
    best_model = self.best_models[algo]
                 ~~~~~~~~~~~~~~~~^^^^^^
TypeError: unhashable type: 'dict'
2025-06-06 22:14:44,323 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 22:14:44,323 - INFO - Directory created or exists: plots
2025-06-06 22:14:44,323 - INFO - Directory created or exists: models
2025-06-06 22:14:44,323 - INFO - Directory created or exists: results
2025-06-06 22:14:44,323 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 22:14:44,332 - INFO - Use pytorch device_name: mps
2025-06-06 22:14:44,332 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 22:14:46,290 - INFO - Processing data...
2025-06-06 22:14:46,541 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 22:14:46,552 - INFO - Mental health status distribution in dataset:
2025-06-06 22:14:46,553 - INFO - Normal: 16343 samples
2025-06-06 22:14:46,553 - INFO - Depression: 15404 samples
2025-06-06 22:14:46,553 - INFO - Suicidal: 10652 samples
2025-06-06 22:14:46,553 - INFO - Anxiety: 3841 samples
2025-06-06 22:14:46,553 - INFO - Bipolar: 2777 samples
2025-06-06 22:14:46,553 - INFO - Stress: 2587 samples
2025-06-06 22:14:46,553 - INFO - Personality disorder: 1077 samples
2025-06-06 22:14:46,553 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 22:14:46,554 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 22:14:52,976 - INFO - Training ML models...
2025-06-06 22:14:52,978 - INFO - Evaluating model: all-MiniLM-L6-v2
2025-06-06 22:14:52,978 - ERROR - Pipeline failed: unhashable type: 'numpy.ndarray'
Traceback (most recent call last):
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/main.py", line 160, in main
    model_results = evaluate_embedding_models(processor, trainer, viz, X_train, X_test, y_train, y_test)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/main.py", line 59, in evaluate_embedding_models
    trainer.train(X_train, y_train, model_name)
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/model_trainer.py", line 34, in train
    if algo not in self.models:
       ^^^^^^^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'numpy.ndarray'
2025-06-06 22:15:46,589 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 22:15:46,589 - INFO - Directory created or exists: plots
2025-06-06 22:15:46,589 - INFO - Directory created or exists: models
2025-06-06 22:15:46,589 - INFO - Directory created or exists: results
2025-06-06 22:15:46,590 - INFO - 
Processing with all-MiniLM-L6-v2 model...
2025-06-06 22:15:46,599 - INFO - Use pytorch device_name: mps
2025-06-06 22:15:46,599 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 22:15:48,570 - INFO - Processing data...
2025-06-06 22:15:48,797 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 22:15:48,807 - INFO - Mental health status distribution in dataset:
2025-06-06 22:15:48,807 - INFO - Normal: 16343 samples
2025-06-06 22:15:48,807 - INFO - Depression: 15404 samples
2025-06-06 22:15:48,807 - INFO - Suicidal: 10652 samples
2025-06-06 22:15:48,807 - INFO - Anxiety: 3841 samples
2025-06-06 22:15:48,807 - INFO - Bipolar: 2777 samples
2025-06-06 22:15:48,807 - INFO - Stress: 2587 samples
2025-06-06 22:15:48,807 - INFO - Personality disorder: 1077 samples
2025-06-06 22:15:48,807 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 22:15:48,809 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 22:15:55,310 - INFO - Training ML models...
2025-06-06 22:15:55,312 - INFO - Evaluating model: all-MiniLM-L6-v2
2025-06-06 22:16:10,035 - INFO - Saved model lr
2025-06-06 22:16:21,683 - INFO - Saved model rf
2025-06-06 22:16:23,727 - INFO - Saved model mlp
2025-06-06 22:16:23,747 - ERROR - Model evaluation error: 'ModelTrainer' object has no attribute 'visualizer'
2025-06-06 22:16:23,747 - ERROR - Error evaluating lr for all-MiniLM-L6-v2: 'ModelTrainer' object has no attribute 'visualizer'
2025-06-06 22:16:23,777 - ERROR - Model evaluation error: 'ModelTrainer' object has no attribute 'visualizer'
2025-06-06 22:16:23,778 - ERROR - Error evaluating rf for all-MiniLM-L6-v2: 'ModelTrainer' object has no attribute 'visualizer'
2025-06-06 22:16:23,787 - ERROR - Model evaluation error: 'ModelTrainer' object has no attribute 'visualizer'
2025-06-06 22:16:23,787 - ERROR - Error evaluating mlp for all-MiniLM-L6-v2: 'ModelTrainer' object has no attribute 'visualizer'
2025-06-06 22:16:23,787 - INFO - Evaluating model: all-mpnet-base-v2
2025-06-06 22:16:58,375 - INFO - === Sentiment Analysis Pipeline Start ===
2025-06-06 22:16:58,375 - INFO - Directory created or exists: plots
2025-06-06 22:16:58,375 - INFO - Directory created or exists: models
2025-06-06 22:16:58,375 - INFO - Directory created or exists: results
2025-06-06 22:16:58,375 - ERROR - Pipeline failed: DataProcessor.__init__() missing 1 required positional argument: 'model_name'
Traceback (most recent call last):
  File "/Users/gaoyuanji/pystudy/LLM-Embedding-based-Mental-Health-Texts-Sentiment-Classification/main.py", line 126, in main
    processor = DataProcessor()
                ^^^^^^^^^^^^^^^
TypeError: DataProcessor.__init__() missing 1 required positional argument: 'model_name'
2025-06-06 22:17:28,172 - INFO - Processing data with model: all-MiniLM-L6-v2
2025-06-06 22:17:28,182 - INFO - Use pytorch device_name: mps
2025-06-06 22:17:28,182 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 22:17:30,149 - ERROR - Pipeline failed: LLMClassifier.__init__() takes 2 positional arguments but 5 were given
2025-06-06 22:18:01,761 - INFO - Processing data with model: all-MiniLM-L6-v2
2025-06-06 22:18:01,770 - INFO - Use pytorch device_name: mps
2025-06-06 22:18:01,770 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 22:18:04,192 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 22:18:04,203 - INFO - Mental health status distribution in dataset:
2025-06-06 22:18:04,203 - INFO - Normal: 16343 samples
2025-06-06 22:18:04,203 - INFO - Depression: 15404 samples
2025-06-06 22:18:04,203 - INFO - Suicidal: 10652 samples
2025-06-06 22:18:04,203 - INFO - Anxiety: 3841 samples
2025-06-06 22:18:04,203 - INFO - Bipolar: 2777 samples
2025-06-06 22:18:04,203 - INFO - Stress: 2587 samples
2025-06-06 22:18:04,203 - INFO - Personality disorder: 1077 samples
2025-06-06 22:18:04,203 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 22:18:04,205 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 22:18:04,483 - ERROR - Pipeline failed: too many values to unpack (expected 4)
2025-06-06 22:19:19,878 - INFO - Processing data with model: all-MiniLM-L6-v2
2025-06-06 22:19:19,887 - INFO - Use pytorch device_name: mps
2025-06-06 22:19:19,887 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 22:19:21,930 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 22:19:21,942 - INFO - Mental health status distribution in dataset:
2025-06-06 22:19:21,942 - INFO - Normal: 16343 samples
2025-06-06 22:19:21,942 - INFO - Depression: 15404 samples
2025-06-06 22:19:21,942 - INFO - Suicidal: 10652 samples
2025-06-06 22:19:21,942 - INFO - Anxiety: 3841 samples
2025-06-06 22:19:21,942 - INFO - Bipolar: 2777 samples
2025-06-06 22:19:21,942 - INFO - Stress: 2587 samples
2025-06-06 22:19:21,942 - INFO - Personality disorder: 1077 samples
2025-06-06 22:19:21,942 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 22:19:21,944 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 22:19:22,143 - INFO - Evaluating model: all-MiniLM-L6-v2
2025-06-06 22:19:36,538 - INFO - Saved model lr
2025-06-06 22:19:47,972 - INFO - Saved model rf
2025-06-06 22:19:50,027 - INFO - Saved model mlp
2025-06-06 22:19:50,046 - ERROR - Model evaluation error: 'Visualizer' object has no attribute 'plot_confusion_matrix'
2025-06-06 22:19:50,046 - ERROR - Error evaluating lr for all-MiniLM-L6-v2: 'Visualizer' object has no attribute 'plot_confusion_matrix'
2025-06-06 22:19:50,080 - ERROR - Model evaluation error: 'Visualizer' object has no attribute 'plot_confusion_matrix'
2025-06-06 22:19:50,080 - ERROR - Error evaluating rf for all-MiniLM-L6-v2: 'Visualizer' object has no attribute 'plot_confusion_matrix'
2025-06-06 22:19:50,089 - ERROR - Model evaluation error: 'Visualizer' object has no attribute 'plot_confusion_matrix'
2025-06-06 22:19:50,089 - ERROR - Error evaluating mlp for all-MiniLM-L6-v2: 'Visualizer' object has no attribute 'plot_confusion_matrix'
2025-06-06 22:19:50,089 - INFO - Evaluating model: all-mpnet-base-v2
2025-06-06 22:20:02,982 - INFO - Saved model lr
2025-06-06 22:20:15,154 - INFO - Saved model rf
2025-06-06 22:20:17,253 - INFO - Saved model mlp
2025-06-06 22:20:17,276 - ERROR - Model evaluation error: 'Visualizer' object has no attribute 'plot_confusion_matrix'
2025-06-06 22:20:17,276 - ERROR - Error evaluating lr for all-mpnet-base-v2: 'Visualizer' object has no attribute 'plot_confusion_matrix'
2025-06-06 22:20:17,309 - ERROR - Model evaluation error: 'Visualizer' object has no attribute 'plot_confusion_matrix'
2025-06-06 22:20:17,309 - ERROR - Error evaluating rf for all-mpnet-base-v2: 'Visualizer' object has no attribute 'plot_confusion_matrix'
2025-06-06 22:20:17,318 - ERROR - Model evaluation error: 'Visualizer' object has no attribute 'plot_confusion_matrix'
2025-06-06 22:20:17,318 - ERROR - Error evaluating mlp for all-mpnet-base-v2: 'Visualizer' object has no attribute 'plot_confusion_matrix'
2025-06-06 22:20:17,318 - INFO - Evaluating model: all-distilroberta-v1
2025-06-06 22:20:30,443 - INFO - Saved model lr
2025-06-06 22:20:45,993 - INFO - Saved model rf
2025-06-06 22:20:48,518 - INFO - Saved model mlp
2025-06-06 22:20:48,538 - ERROR - Model evaluation error: 'Visualizer' object has no attribute 'plot_confusion_matrix'
2025-06-06 22:20:48,538 - ERROR - Error evaluating lr for all-distilroberta-v1: 'Visualizer' object has no attribute 'plot_confusion_matrix'
2025-06-06 22:20:48,572 - ERROR - Model evaluation error: 'Visualizer' object has no attribute 'plot_confusion_matrix'
2025-06-06 22:20:48,572 - ERROR - Error evaluating rf for all-distilroberta-v1: 'Visualizer' object has no attribute 'plot_confusion_matrix'
2025-06-06 22:20:48,582 - ERROR - Model evaluation error: 'Visualizer' object has no attribute 'plot_confusion_matrix'
2025-06-06 22:20:48,582 - ERROR - Error evaluating mlp for all-distilroberta-v1: 'Visualizer' object has no attribute 'plot_confusion_matrix'
2025-06-06 22:20:48,582 - INFO - Evaluating model: all-MiniLM-L12-v2
2025-06-06 22:21:03,141 - INFO - Saved model lr
2025-06-06 22:21:15,740 - INFO - Processing data with model: all-MiniLM-L6-v2
2025-06-06 22:21:15,753 - INFO - Use pytorch device_name: mps
2025-06-06 22:21:15,753 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 22:21:18,370 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 22:21:18,384 - INFO - Mental health status distribution in dataset:
2025-06-06 22:21:18,384 - INFO - Normal: 16343 samples
2025-06-06 22:21:18,384 - INFO - Depression: 15404 samples
2025-06-06 22:21:18,384 - INFO - Suicidal: 10652 samples
2025-06-06 22:21:18,384 - INFO - Anxiety: 3841 samples
2025-06-06 22:21:18,384 - INFO - Bipolar: 2777 samples
2025-06-06 22:21:18,384 - INFO - Stress: 2587 samples
2025-06-06 22:21:18,384 - INFO - Personality disorder: 1077 samples
2025-06-06 22:21:18,384 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 22:21:18,386 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 22:21:18,603 - INFO - Evaluating model: all-MiniLM-L6-v2
2025-06-06 22:21:33,859 - INFO - Saved model lr
2025-06-06 22:21:46,688 - INFO - Saved model rf
2025-06-06 22:21:49,085 - INFO - Saved model mlp
2025-06-06 22:21:49,377 - ERROR - Model evaluation error: No axis named 1 for object type Series
2025-06-06 22:21:49,377 - ERROR - Error evaluating lr for all-MiniLM-L6-v2: No axis named 1 for object type Series
2025-06-06 22:21:49,507 - ERROR - Model evaluation error: No axis named 1 for object type Series
2025-06-06 22:21:49,507 - ERROR - Error evaluating rf for all-MiniLM-L6-v2: No axis named 1 for object type Series
2025-06-06 22:21:49,611 - ERROR - Model evaluation error: No axis named 1 for object type Series
2025-06-06 22:21:49,611 - ERROR - Error evaluating mlp for all-MiniLM-L6-v2: No axis named 1 for object type Series
2025-06-06 22:21:49,611 - INFO - Evaluating model: all-mpnet-base-v2
2025-06-06 22:22:03,826 - INFO - Saved model lr
2025-06-06 22:22:19,022 - INFO - Saved model rf
2025-06-06 22:22:21,253 - INFO - Saved model mlp
2025-06-06 22:22:21,376 - ERROR - Model evaluation error: No axis named 1 for object type Series
2025-06-06 22:22:21,376 - ERROR - Error evaluating lr for all-mpnet-base-v2: No axis named 1 for object type Series
2025-06-06 22:22:21,503 - ERROR - Model evaluation error: No axis named 1 for object type Series
2025-06-06 22:22:21,503 - ERROR - Error evaluating rf for all-mpnet-base-v2: No axis named 1 for object type Series
2025-06-06 22:22:21,600 - ERROR - Model evaluation error: No axis named 1 for object type Series
2025-06-06 22:22:21,600 - ERROR - Error evaluating mlp for all-mpnet-base-v2: No axis named 1 for object type Series
2025-06-06 22:22:21,600 - INFO - Evaluating model: all-distilroberta-v1
2025-06-06 22:22:36,854 - INFO - Processing data with model: all-MiniLM-L6-v2
2025-06-06 22:22:36,868 - INFO - Use pytorch device_name: mps
2025-06-06 22:22:36,868 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 22:22:39,174 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 22:22:39,183 - INFO - Mental health status distribution in dataset:
2025-06-06 22:22:39,183 - INFO - Normal: 16343 samples
2025-06-06 22:22:39,183 - INFO - Depression: 15404 samples
2025-06-06 22:22:39,183 - INFO - Suicidal: 10652 samples
2025-06-06 22:22:39,183 - INFO - Anxiety: 3841 samples
2025-06-06 22:22:39,183 - INFO - Bipolar: 2777 samples
2025-06-06 22:22:39,183 - INFO - Stress: 2587 samples
2025-06-06 22:22:39,183 - INFO - Personality disorder: 1077 samples
2025-06-06 22:22:39,183 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 22:22:39,185 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 22:22:39,382 - INFO - Evaluating model: all-MiniLM-L6-v2
2025-06-06 22:22:56,400 - INFO - Saved model lr
2025-06-06 22:23:11,775 - INFO - Saved model rf
2025-06-06 22:23:13,941 - INFO - Saved model mlp
2025-06-06 22:23:14,181 - ERROR - Model evaluation error: axis 1 is out of bounds for array of dimension 1
2025-06-06 22:23:14,181 - ERROR - Error evaluating lr for all-MiniLM-L6-v2: axis 1 is out of bounds for array of dimension 1
2025-06-06 22:23:14,301 - ERROR - Model evaluation error: axis 1 is out of bounds for array of dimension 1
2025-06-06 22:23:14,301 - ERROR - Error evaluating rf for all-MiniLM-L6-v2: axis 1 is out of bounds for array of dimension 1
2025-06-06 22:23:14,399 - ERROR - Model evaluation error: axis 1 is out of bounds for array of dimension 1
2025-06-06 22:23:14,399 - ERROR - Error evaluating mlp for all-MiniLM-L6-v2: axis 1 is out of bounds for array of dimension 1
2025-06-06 22:23:14,399 - INFO - Evaluating model: all-mpnet-base-v2
2025-06-06 22:23:30,133 - INFO - Saved model lr
2025-06-06 22:23:44,793 - INFO - Saved model rf
2025-06-06 22:23:46,958 - INFO - Saved model mlp
2025-06-06 22:23:47,077 - ERROR - Model evaluation error: axis 1 is out of bounds for array of dimension 1
2025-06-06 22:23:47,078 - ERROR - Error evaluating lr for all-mpnet-base-v2: axis 1 is out of bounds for array of dimension 1
2025-06-06 22:23:47,195 - ERROR - Model evaluation error: axis 1 is out of bounds for array of dimension 1
2025-06-06 22:23:47,195 - ERROR - Error evaluating rf for all-mpnet-base-v2: axis 1 is out of bounds for array of dimension 1
2025-06-06 22:23:47,296 - ERROR - Model evaluation error: axis 1 is out of bounds for array of dimension 1
2025-06-06 22:23:47,296 - ERROR - Error evaluating mlp for all-mpnet-base-v2: axis 1 is out of bounds for array of dimension 1
2025-06-06 22:23:47,296 - INFO - Evaluating model: all-distilroberta-v1
2025-06-06 22:24:26,503 - INFO - Processing data with model: all-MiniLM-L6-v2
2025-06-06 22:24:26,516 - INFO - Use pytorch device_name: mps
2025-06-06 22:24:26,516 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 22:24:28,777 - ERROR - Data processing error: 'DataProcessor' object has no attribute 'data_path'
2025-06-06 22:24:28,777 - ERROR - Pipeline failed: 'DataProcessor' object has no attribute 'data_path'
2025-06-06 22:25:12,806 - INFO - Processing data with model: all-MiniLM-L6-v2
2025-06-06 22:25:12,815 - INFO - Use pytorch device_name: mps
2025-06-06 22:25:12,815 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 22:25:14,891 - INFO - Mental health status distribution in dataset:
2025-06-06 22:25:14,892 - INFO - Normal: 16351 samples
2025-06-06 22:25:14,892 - INFO - Depression: 15404 samples
2025-06-06 22:25:14,892 - INFO - Suicidal: 10653 samples
2025-06-06 22:25:14,892 - INFO - Anxiety: 3888 samples
2025-06-06 22:25:14,892 - INFO - Bipolar: 2877 samples
2025-06-06 22:25:14,892 - INFO - Stress: 2669 samples
2025-06-06 22:25:14,892 - INFO - Personality disorder: 1201 samples
2025-06-06 22:25:14,892 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 22:25:14,894 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 22:25:14,942 - ERROR - Data processing error: Found input variables with inconsistent numbers of samples: [52681, 53043]
2025-06-06 22:25:14,942 - ERROR - Pipeline failed: Found input variables with inconsistent numbers of samples: [52681, 53043]
2025-06-06 22:27:13,978 - INFO - Processing data with model: all-MiniLM-L6-v2
2025-06-06 22:27:13,986 - INFO - Use pytorch device_name: mps
2025-06-06 22:27:13,987 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 22:27:16,531 - INFO - Mental health status distribution in dataset:
2025-06-06 22:27:16,531 - INFO - Normal: 16343 samples
2025-06-06 22:27:16,531 - INFO - Depression: 15404 samples
2025-06-06 22:27:16,531 - INFO - Suicidal: 10652 samples
2025-06-06 22:27:16,531 - INFO - Anxiety: 3841 samples
2025-06-06 22:27:16,531 - INFO - Bipolar: 2777 samples
2025-06-06 22:27:16,531 - INFO - Stress: 2587 samples
2025-06-06 22:27:16,531 - INFO - Personality disorder: 1077 samples
2025-06-06 22:27:16,531 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 22:27:16,533 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 22:27:16,639 - INFO - Evaluating model: all-MiniLM-L6-v2
2025-06-06 22:27:30,319 - INFO - Saved model lr
2025-06-06 22:27:41,878 - INFO - Saved model rf
2025-06-06 22:27:46,872 - INFO - Saved model mlp
2025-06-06 22:27:47,125 - ERROR - Model evaluation error: axis 1 is out of bounds for array of dimension 1
2025-06-06 22:27:47,125 - ERROR - Error evaluating lr for all-MiniLM-L6-v2: axis 1 is out of bounds for array of dimension 1
2025-06-06 22:27:47,243 - ERROR - Model evaluation error: axis 1 is out of bounds for array of dimension 1
2025-06-06 22:27:47,243 - ERROR - Error evaluating rf for all-MiniLM-L6-v2: axis 1 is out of bounds for array of dimension 1
2025-06-06 22:27:47,337 - ERROR - Model evaluation error: axis 1 is out of bounds for array of dimension 1
2025-06-06 22:27:47,337 - ERROR - Error evaluating mlp for all-MiniLM-L6-v2: axis 1 is out of bounds for array of dimension 1
2025-06-06 22:27:47,337 - INFO - Evaluating model: all-mpnet-base-v2
2025-06-06 22:28:20,896 - INFO - Processing data with model: all-MiniLM-L6-v2
2025-06-06 22:28:20,905 - INFO - Use pytorch device_name: mps
2025-06-06 22:28:20,905 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 22:28:22,982 - INFO - Mental health status distribution in dataset:
2025-06-06 22:28:22,982 - INFO - Normal: 16343 samples
2025-06-06 22:28:22,982 - INFO - Depression: 15404 samples
2025-06-06 22:28:22,982 - INFO - Suicidal: 10652 samples
2025-06-06 22:28:22,982 - INFO - Anxiety: 3841 samples
2025-06-06 22:28:22,982 - INFO - Bipolar: 2777 samples
2025-06-06 22:28:22,982 - INFO - Stress: 2587 samples
2025-06-06 22:28:22,982 - INFO - Personality disorder: 1077 samples
2025-06-06 22:28:22,982 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 22:28:22,984 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 22:28:23,086 - INFO - Evaluating model: all-MiniLM-L6-v2
2025-06-06 22:28:36,266 - INFO - Saved model lr
2025-06-06 22:28:49,637 - INFO - Saved model rf
2025-06-06 22:28:54,743 - INFO - Saved model mlp
2025-06-06 22:28:54,983 - ERROR - Model evaluation error: axis 1 is out of bounds for array of dimension 1
2025-06-06 22:28:54,983 - ERROR - Error evaluating lr for all-MiniLM-L6-v2: axis 1 is out of bounds for array of dimension 1
2025-06-06 22:28:55,086 - ERROR - Model evaluation error: axis 1 is out of bounds for array of dimension 1
2025-06-06 22:28:55,086 - ERROR - Error evaluating rf for all-MiniLM-L6-v2: axis 1 is out of bounds for array of dimension 1
2025-06-06 22:28:55,179 - ERROR - Model evaluation error: axis 1 is out of bounds for array of dimension 1
2025-06-06 22:28:55,179 - ERROR - Error evaluating mlp for all-MiniLM-L6-v2: axis 1 is out of bounds for array of dimension 1
2025-06-06 22:28:55,179 - INFO - Evaluating model: all-mpnet-base-v2
2025-06-06 22:29:38,742 - INFO - Processing data with model: all-MiniLM-L6-v2
2025-06-06 22:29:38,751 - INFO - Use pytorch device_name: mps
2025-06-06 22:29:38,751 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 22:29:41,028 - INFO - Mental health status distribution in dataset:
2025-06-06 22:29:41,029 - INFO - Normal: 16343 samples
2025-06-06 22:29:41,029 - INFO - Depression: 15404 samples
2025-06-06 22:29:41,029 - INFO - Suicidal: 10652 samples
2025-06-06 22:29:41,029 - INFO - Anxiety: 3841 samples
2025-06-06 22:29:41,029 - INFO - Bipolar: 2777 samples
2025-06-06 22:29:41,029 - INFO - Stress: 2587 samples
2025-06-06 22:29:41,029 - INFO - Personality disorder: 1077 samples
2025-06-06 22:29:41,029 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 22:29:41,031 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 22:29:41,119 - INFO - Evaluating model: all-MiniLM-L6-v2
2025-06-06 22:29:54,670 - INFO - Saved model lr
2025-06-06 22:30:06,678 - INFO - Saved model rf
2025-06-06 22:30:12,024 - INFO - Saved model mlp
2025-06-06 22:30:12,258 - ERROR - Learning curve plot error: name 'CV_FOLDS' is not defined
2025-06-06 22:30:12,258 - ERROR - Model evaluation error: name 'CV_FOLDS' is not defined
2025-06-06 22:30:12,258 - ERROR - Error evaluating lr for all-MiniLM-L6-v2: name 'CV_FOLDS' is not defined
2025-06-06 22:30:12,380 - ERROR - Learning curve plot error: name 'CV_FOLDS' is not defined
2025-06-06 22:30:12,381 - ERROR - Model evaluation error: name 'CV_FOLDS' is not defined
2025-06-06 22:30:12,381 - ERROR - Error evaluating rf for all-MiniLM-L6-v2: name 'CV_FOLDS' is not defined
2025-06-06 22:30:12,482 - ERROR - Learning curve plot error: name 'CV_FOLDS' is not defined
2025-06-06 22:30:12,482 - ERROR - Model evaluation error: name 'CV_FOLDS' is not defined
2025-06-06 22:30:12,482 - ERROR - Error evaluating mlp for all-MiniLM-L6-v2: name 'CV_FOLDS' is not defined
2025-06-06 22:30:12,482 - INFO - Evaluating model: all-mpnet-base-v2
2025-06-06 22:30:24,298 - INFO - Saved model lr
2025-06-06 22:30:48,269 - INFO - Processing data with model: all-MiniLM-L6-v2
2025-06-06 22:30:48,278 - INFO - Use pytorch device_name: mps
2025-06-06 22:30:48,278 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 22:30:50,316 - INFO - Mental health status distribution in dataset:
2025-06-06 22:30:50,316 - INFO - Normal: 16343 samples
2025-06-06 22:30:50,316 - INFO - Depression: 15404 samples
2025-06-06 22:30:50,316 - INFO - Suicidal: 10652 samples
2025-06-06 22:30:50,316 - INFO - Anxiety: 3841 samples
2025-06-06 22:30:50,316 - INFO - Bipolar: 2777 samples
2025-06-06 22:30:50,316 - INFO - Stress: 2587 samples
2025-06-06 22:30:50,316 - INFO - Personality disorder: 1077 samples
2025-06-06 22:30:50,316 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 22:30:50,317 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 22:30:50,410 - INFO - Evaluating model: all-MiniLM-L6-v2
2025-06-06 22:31:03,771 - INFO - Saved model lr
2025-06-06 22:31:16,352 - INFO - Saved model rf
2025-06-06 22:31:21,370 - INFO - Saved model mlp
2025-06-06 22:31:23,825 - ERROR - Error evaluating lr for all-MiniLM-L6-v2: 'float' object is not subscriptable
2025-06-06 22:31:33,172 - ERROR - Error evaluating rf for all-MiniLM-L6-v2: 'float' object is not subscriptable
2025-06-06 22:31:35,099 - ERROR - Error evaluating mlp for all-MiniLM-L6-v2: 'float' object is not subscriptable
2025-06-06 22:31:35,099 - INFO - Evaluating model: all-mpnet-base-v2
2025-06-06 22:31:46,824 - INFO - Saved model lr
2025-06-06 22:31:59,328 - INFO - Saved model rf
2025-06-06 22:32:05,538 - INFO - Saved model mlp
2025-06-06 22:32:08,023 - ERROR - Error evaluating lr for all-mpnet-base-v2: 'float' object is not subscriptable
2025-06-06 22:32:18,177 - ERROR - Error evaluating rf for all-mpnet-base-v2: 'float' object is not subscriptable
2025-06-06 22:32:20,375 - ERROR - Error evaluating mlp for all-mpnet-base-v2: 'float' object is not subscriptable
2025-06-06 22:32:20,376 - INFO - Evaluating model: all-distilroberta-v1
2025-06-06 22:32:59,309 - INFO - Processing data with model: all-MiniLM-L6-v2
2025-06-06 22:32:59,321 - INFO - Use pytorch device_name: mps
2025-06-06 22:32:59,321 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 22:33:01,580 - INFO - Mental health status distribution in dataset:
2025-06-06 22:33:01,580 - INFO - Normal: 16343 samples
2025-06-06 22:33:01,580 - INFO - Depression: 15404 samples
2025-06-06 22:33:01,580 - INFO - Suicidal: 10652 samples
2025-06-06 22:33:01,580 - INFO - Anxiety: 3841 samples
2025-06-06 22:33:01,580 - INFO - Bipolar: 2777 samples
2025-06-06 22:33:01,580 - INFO - Stress: 2587 samples
2025-06-06 22:33:01,580 - INFO - Personality disorder: 1077 samples
2025-06-06 22:33:01,580 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 22:33:01,582 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 22:33:01,681 - INFO - Evaluating model: all-MiniLM-L6-v2
2025-06-06 22:33:16,028 - INFO - Saved model lr
2025-06-06 22:33:29,870 - INFO - Saved model rf
2025-06-06 22:33:34,995 - INFO - Saved model mlp
2025-06-06 22:33:37,413 - ERROR - Error evaluating lr for all-MiniLM-L6-v2: 'float' object is not subscriptable
2025-06-06 22:33:46,806 - ERROR - Error evaluating rf for all-MiniLM-L6-v2: 'float' object is not subscriptable
2025-06-06 22:33:48,719 - ERROR - Error evaluating mlp for all-MiniLM-L6-v2: 'float' object is not subscriptable
2025-06-06 22:33:48,719 - INFO - Evaluating model: all-mpnet-base-v2
2025-06-06 22:34:01,018 - INFO - Saved model lr
2025-06-06 22:34:14,272 - INFO - Saved model rf
2025-06-06 22:34:19,800 - INFO - Saved model mlp
2025-06-06 22:34:56,986 - INFO - Processing data with model: all-MiniLM-L6-v2
2025-06-06 22:34:56,998 - INFO - Use pytorch device_name: mps
2025-06-06 22:34:56,998 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 22:34:59,241 - INFO - Mental health status distribution in dataset:
2025-06-06 22:34:59,242 - INFO - Normal: 16343 samples
2025-06-06 22:34:59,242 - INFO - Depression: 15404 samples
2025-06-06 22:34:59,242 - INFO - Suicidal: 10652 samples
2025-06-06 22:34:59,242 - INFO - Anxiety: 3841 samples
2025-06-06 22:34:59,242 - INFO - Bipolar: 2777 samples
2025-06-06 22:34:59,242 - INFO - Stress: 2587 samples
2025-06-06 22:34:59,242 - INFO - Personality disorder: 1077 samples
2025-06-06 22:34:59,242 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 22:34:59,243 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 22:34:59,337 - INFO - Evaluating model: all-MiniLM-L6-v2
2025-06-06 22:35:12,922 - INFO - Saved model lr
2025-06-06 22:35:24,835 - INFO - Saved model rf
2025-06-06 22:35:29,858 - INFO - Saved model mlp
2025-06-06 22:35:43,989 - INFO - Evaluating model: all-mpnet-base-v2
2025-06-06 22:35:57,031 - INFO - Saved model lr
2025-06-06 22:36:12,816 - INFO - Saved model rf
2025-06-06 22:36:18,566 - INFO - Saved model mlp
2025-06-06 22:36:38,813 - INFO - Evaluating model: all-distilroberta-v1
2025-06-06 22:36:55,386 - INFO - Saved model lr
2025-06-06 22:40:20,780 - INFO - Processing data with model: all-MiniLM-L6-v2
2025-06-06 22:40:20,790 - INFO - Use pytorch device_name: mps
2025-06-06 22:40:20,790 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 22:40:23,344 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 22:40:23,348 - INFO - Mental health status distribution in dataset:
2025-06-06 22:40:23,348 - INFO - Normal: 16343 samples
2025-06-06 22:40:23,348 - INFO - Depression: 15404 samples
2025-06-06 22:40:23,348 - INFO - Suicidal: 10652 samples
2025-06-06 22:40:23,348 - INFO - Anxiety: 3841 samples
2025-06-06 22:40:23,348 - INFO - Bipolar: 2777 samples
2025-06-06 22:40:23,348 - INFO - Stress: 2587 samples
2025-06-06 22:40:23,348 - INFO - Personality disorder: 1077 samples
2025-06-06 22:40:23,348 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 22:40:23,349 - INFO - Loading existing embeddings from models/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 22:40:23,449 - INFO - Evaluating model: all-MiniLM-L6-v2
2025-06-06 22:40:37,175 - INFO - Saved model lr
2025-06-06 22:40:50,178 - INFO - Saved model rf
2025-06-06 22:40:55,136 - INFO - Saved model mlp
2025-06-06 22:41:09,378 - INFO - Evaluating model: all-mpnet-base-v2
2025-06-06 22:41:21,567 - INFO - Saved model lr
2025-06-06 22:41:34,007 - INFO - Saved model rf
2025-06-06 22:41:39,316 - INFO - Saved model mlp
2025-06-06 22:45:38,900 - INFO - Processing and evaluating model: all-MiniLM-L6-v2
2025-06-06 22:45:38,911 - INFO - Use pytorch device_name: mps
2025-06-06 22:45:38,911 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 22:45:41,680 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 22:45:41,683 - INFO - Mental health status distribution in dataset:
2025-06-06 22:45:41,683 - INFO - Normal: 16343 samples
2025-06-06 22:45:41,683 - INFO - Depression: 15404 samples
2025-06-06 22:45:41,683 - INFO - Suicidal: 10652 samples
2025-06-06 22:45:41,683 - INFO - Anxiety: 3841 samples
2025-06-06 22:45:41,683 - INFO - Bipolar: 2777 samples
2025-06-06 22:45:41,683 - INFO - Stress: 2587 samples
2025-06-06 22:45:41,683 - INFO - Personality disorder: 1077 samples
2025-06-06 22:45:41,683 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 22:45:41,685 - INFO - Generating embeddings using all-MiniLM-L6-v2
2025-06-06 22:46:08,007 - INFO - Processing and evaluating model: all-MiniLM-L6-v2
2025-06-06 22:46:08,016 - INFO - Use pytorch device_name: mps
2025-06-06 22:46:08,016 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 22:46:10,226 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 22:46:10,229 - INFO - Mental health status distribution in dataset:
2025-06-06 22:46:10,229 - INFO - Normal: 16343 samples
2025-06-06 22:46:10,230 - INFO - Depression: 15404 samples
2025-06-06 22:46:10,230 - INFO - Suicidal: 10652 samples
2025-06-06 22:46:10,230 - INFO - Anxiety: 3841 samples
2025-06-06 22:46:10,230 - INFO - Bipolar: 2777 samples
2025-06-06 22:46:10,230 - INFO - Stress: 2587 samples
2025-06-06 22:46:10,230 - INFO - Personality disorder: 1077 samples
2025-06-06 22:46:10,230 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 22:46:10,231 - INFO - Generating embeddings using all-MiniLM-L6-v2
2025-06-06 22:48:27,219 - INFO - Directory created or exists: plots
2025-06-06 22:48:27,220 - INFO - Directory created or exists: models
2025-06-06 22:48:27,220 - INFO - Directory created or exists: results
2025-06-06 22:48:27,220 - ERROR - Pipeline failed: 'seaborn' is not a valid package style, path of style file, URL of style file, or library style name (library styles are listed in `style.available`)
2025-06-06 22:48:51,294 - INFO - Directory created or exists: plots
2025-06-06 22:48:51,294 - INFO - Directory created or exists: models
2025-06-06 22:48:51,295 - INFO - Directory created or exists: results
2025-06-06 22:48:51,295 - INFO - Processing and evaluating model: all-MiniLM-L6-v2
2025-06-06 22:48:51,304 - INFO - Use pytorch device_name: mps
2025-06-06 22:48:51,304 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 22:48:53,678 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 22:48:53,681 - INFO - Mental health status distribution in dataset:
2025-06-06 22:48:53,681 - INFO - Normal: 16343 samples
2025-06-06 22:48:53,681 - INFO - Depression: 15404 samples
2025-06-06 22:48:53,681 - INFO - Suicidal: 10652 samples
2025-06-06 22:48:53,681 - INFO - Anxiety: 3841 samples
2025-06-06 22:48:53,681 - INFO - Bipolar: 2777 samples
2025-06-06 22:48:53,681 - INFO - Stress: 2587 samples
2025-06-06 22:48:53,681 - INFO - Personality disorder: 1077 samples
2025-06-06 22:48:53,681 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 22:48:53,682 - INFO - Generating embeddings using all-MiniLM-L6-v2
2025-06-06 22:51:26,897 - INFO - Directory created or exists: plots
2025-06-06 22:51:26,897 - INFO - Directory created or exists: models
2025-06-06 22:51:26,897 - INFO - Directory created or exists: results
2025-06-06 22:51:26,897 - INFO - Processing and evaluating model: all-MiniLM-L6-v2
2025-06-06 22:51:26,907 - INFO - Use pytorch device_name: mps
2025-06-06 22:51:26,908 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 22:51:28,871 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 22:51:28,875 - INFO - Mental health status distribution in dataset:
2025-06-06 22:51:28,875 - INFO - Normal: 16343 samples
2025-06-06 22:51:28,875 - INFO - Depression: 15404 samples
2025-06-06 22:51:28,875 - INFO - Suicidal: 10652 samples
2025-06-06 22:51:28,875 - INFO - Anxiety: 3841 samples
2025-06-06 22:51:28,875 - INFO - Bipolar: 2777 samples
2025-06-06 22:51:28,875 - INFO - Stress: 2587 samples
2025-06-06 22:51:28,875 - INFO - Personality disorder: 1077 samples
2025-06-06 22:51:28,875 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 22:51:28,876 - INFO - Generating embeddings using all-MiniLM-L6-v2
2025-06-06 22:52:51,504 - INFO - Directory created or exists: plots
2025-06-06 22:52:51,504 - INFO - Directory created or exists: models
2025-06-06 22:52:51,504 - INFO - Directory created or exists: results
2025-06-06 22:52:51,504 - INFO - Processing and evaluating model: all-MiniLM-L6-v2
2025-06-06 22:52:51,514 - INFO - Use pytorch device_name: mps
2025-06-06 22:52:51,515 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 22:52:53,561 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 22:52:53,568 - INFO - Mental health status distribution in dataset:
2025-06-06 22:52:53,568 - INFO - Normal: 16343 samples
2025-06-06 22:52:53,568 - INFO - Depression: 15404 samples
2025-06-06 22:52:53,568 - INFO - Suicidal: 10652 samples
2025-06-06 22:52:53,568 - INFO - Anxiety: 3841 samples
2025-06-06 22:52:53,568 - INFO - Bipolar: 2777 samples
2025-06-06 22:52:53,568 - INFO - Stress: 2587 samples
2025-06-06 22:52:53,568 - INFO - Personality disorder: 1077 samples
2025-06-06 22:52:53,568 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 22:52:53,570 - INFO - Generating embeddings using all-MiniLM-L6-v2
2025-06-06 22:56:45,266 - INFO - Saved embeddings to embeddings/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 22:56:45,428 - INFO - Generating data visualizations...
2025-06-06 22:56:45,776 - INFO - Saved text length distribution plot
2025-06-06 22:56:45,885 - INFO - Saved class distribution plot
2025-06-06 22:56:45,998 - INFO - Saved length by class plot
2025-06-06 22:57:59,516 - INFO - Directory created or exists: plots
2025-06-06 22:57:59,516 - INFO - Directory created or exists: models
2025-06-06 22:57:59,516 - INFO - Directory created or exists: results
2025-06-06 22:57:59,516 - INFO - Processing and evaluating model: all-MiniLM-L6-v2
2025-06-06 22:57:59,526 - INFO - Use pytorch device_name: mps
2025-06-06 22:57:59,526 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 22:58:01,802 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 22:58:01,804 - INFO - Mental health status distribution in dataset:
2025-06-06 22:58:01,805 - INFO - Normal: 16343 samples
2025-06-06 22:58:01,805 - INFO - Depression: 15404 samples
2025-06-06 22:58:01,805 - INFO - Suicidal: 10652 samples
2025-06-06 22:58:01,805 - INFO - Anxiety: 3841 samples
2025-06-06 22:58:01,805 - INFO - Bipolar: 2777 samples
2025-06-06 22:58:01,805 - INFO - Stress: 2587 samples
2025-06-06 22:58:01,805 - INFO - Personality disorder: 1077 samples
2025-06-06 22:58:01,805 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 22:58:01,806 - INFO - Loading existing embeddings from embeddings/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 22:58:01,906 - INFO - Generating data visualizations...
2025-06-06 22:58:02,065 - INFO - Saved text length distribution plot
2025-06-06 22:58:02,154 - INFO - Saved class distribution plot
2025-06-06 22:58:02,257 - INFO - Saved length by class plot
2025-06-06 22:58:54,864 - INFO - Directory created or exists: plots
2025-06-06 22:58:54,864 - INFO - Directory created or exists: models
2025-06-06 22:58:54,864 - INFO - Directory created or exists: results
2025-06-06 22:58:54,864 - INFO - Processing and evaluating model: all-MiniLM-L6-v2
2025-06-06 22:58:54,875 - INFO - Use pytorch device_name: mps
2025-06-06 22:58:54,875 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 22:58:56,927 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 22:58:56,929 - INFO - Mental health status distribution in dataset:
2025-06-06 22:58:56,930 - INFO - Normal: 16343 samples
2025-06-06 22:58:56,930 - INFO - Depression: 15404 samples
2025-06-06 22:58:56,930 - INFO - Suicidal: 10652 samples
2025-06-06 22:58:56,930 - INFO - Anxiety: 3841 samples
2025-06-06 22:58:56,930 - INFO - Bipolar: 2777 samples
2025-06-06 22:58:56,930 - INFO - Stress: 2587 samples
2025-06-06 22:58:56,930 - INFO - Personality disorder: 1077 samples
2025-06-06 22:58:56,930 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 22:58:56,931 - INFO - Loading existing embeddings from embeddings/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 22:58:57,107 - INFO - Generating data visualizations...
2025-06-06 22:58:57,265 - INFO - Saved text length distribution plot
2025-06-06 22:58:57,351 - INFO - Saved class distribution plot
2025-06-06 22:58:57,445 - INFO - Saved length by class plot
2025-06-06 23:00:01,568 - INFO - Directory created or exists: plots
2025-06-06 23:00:01,568 - INFO - Directory created or exists: models
2025-06-06 23:00:01,568 - INFO - Directory created or exists: results
2025-06-06 23:00:01,568 - INFO - Processing and evaluating model: all-MiniLM-L6-v2
2025-06-06 23:00:01,580 - INFO - Use pytorch device_name: mps
2025-06-06 23:00:01,580 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 23:00:04,590 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 23:00:04,593 - INFO - Mental health status distribution in dataset:
2025-06-06 23:00:04,593 - INFO - Normal: 16343 samples
2025-06-06 23:00:04,593 - INFO - Depression: 15404 samples
2025-06-06 23:00:04,593 - INFO - Suicidal: 10652 samples
2025-06-06 23:00:04,593 - INFO - Anxiety: 3841 samples
2025-06-06 23:00:04,593 - INFO - Bipolar: 2777 samples
2025-06-06 23:00:04,593 - INFO - Stress: 2587 samples
2025-06-06 23:00:04,593 - INFO - Personality disorder: 1077 samples
2025-06-06 23:00:04,593 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 23:00:04,594 - INFO - Loading existing embeddings from embeddings/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 23:00:04,698 - INFO - Generating data visualizations...
2025-06-06 23:00:04,862 - INFO - Saved text length distribution plot
2025-06-06 23:00:04,947 - INFO - Saved class distribution plot
2025-06-06 23:00:05,044 - INFO - Saved length by class plot
2025-06-06 23:01:10,545 - INFO - Directory created or exists: plots
2025-06-06 23:01:10,546 - INFO - Directory created or exists: models
2025-06-06 23:01:10,546 - INFO - Directory created or exists: results
2025-06-06 23:01:10,546 - INFO - Processing and evaluating model: all-MiniLM-L6-v2
2025-06-06 23:01:10,555 - INFO - Use pytorch device_name: mps
2025-06-06 23:01:10,555 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 23:01:12,868 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 23:01:12,871 - INFO - Mental health status distribution in dataset:
2025-06-06 23:01:12,871 - INFO - Normal: 16343 samples
2025-06-06 23:01:12,871 - INFO - Depression: 15404 samples
2025-06-06 23:01:12,871 - INFO - Suicidal: 10652 samples
2025-06-06 23:01:12,871 - INFO - Anxiety: 3841 samples
2025-06-06 23:01:12,871 - INFO - Bipolar: 2777 samples
2025-06-06 23:01:12,871 - INFO - Stress: 2587 samples
2025-06-06 23:01:12,871 - INFO - Personality disorder: 1077 samples
2025-06-06 23:01:12,871 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 23:01:12,872 - INFO - Loading existing embeddings from embeddings/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 23:01:12,988 - INFO - Generating data visualizations...
2025-06-06 23:01:13,141 - INFO - Saved text length distribution plot
2025-06-06 23:01:13,226 - INFO - Saved class distribution plot
2025-06-06 23:01:13,317 - INFO - Saved length by class plot
2025-06-06 23:02:27,685 - INFO - Directory created or exists: plots
2025-06-06 23:02:27,686 - INFO - Directory created or exists: models
2025-06-06 23:02:27,686 - INFO - Directory created or exists: results
2025-06-06 23:02:27,686 - INFO - Processing and evaluating model: all-MiniLM-L6-v2
2025-06-06 23:02:27,699 - INFO - Use pytorch device_name: mps
2025-06-06 23:02:27,700 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 23:02:29,748 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 23:02:29,752 - INFO - Mental health status distribution in dataset:
2025-06-06 23:02:29,752 - INFO - Normal: 16343 samples
2025-06-06 23:02:29,752 - INFO - Depression: 15404 samples
2025-06-06 23:02:29,752 - INFO - Suicidal: 10652 samples
2025-06-06 23:02:29,752 - INFO - Anxiety: 3841 samples
2025-06-06 23:02:29,752 - INFO - Bipolar: 2777 samples
2025-06-06 23:02:29,752 - INFO - Stress: 2587 samples
2025-06-06 23:02:29,752 - INFO - Personality disorder: 1077 samples
2025-06-06 23:02:29,752 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 23:02:29,753 - INFO - Loading existing embeddings from embeddings/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 23:02:29,850 - INFO - Generating data visualizations...
2025-06-06 23:02:29,993 - INFO - Saved text length distribution plot
2025-06-06 23:02:30,077 - INFO - Saved class distribution plot
2025-06-06 23:02:30,169 - INFO - Saved length by class plot
2025-06-06 23:02:31,438 - INFO - Saved model lr
2025-06-06 23:03:05,426 - INFO - Directory created or exists: plots
2025-06-06 23:03:05,426 - INFO - Directory created or exists: models
2025-06-06 23:03:05,426 - INFO - Directory created or exists: results
2025-06-06 23:03:05,426 - INFO - Processing and evaluating model: all-MiniLM-L6-v2
2025-06-06 23:03:05,435 - INFO - Use pytorch device_name: mps
2025-06-06 23:03:05,435 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-06-06 23:03:07,497 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 23:03:07,500 - INFO - Mental health status distribution in dataset:
2025-06-06 23:03:07,500 - INFO - Normal: 16343 samples
2025-06-06 23:03:07,500 - INFO - Depression: 15404 samples
2025-06-06 23:03:07,500 - INFO - Suicidal: 10652 samples
2025-06-06 23:03:07,500 - INFO - Anxiety: 3841 samples
2025-06-06 23:03:07,500 - INFO - Bipolar: 2777 samples
2025-06-06 23:03:07,500 - INFO - Stress: 2587 samples
2025-06-06 23:03:07,500 - INFO - Personality disorder: 1077 samples
2025-06-06 23:03:07,500 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 23:03:07,501 - INFO - Loading existing embeddings from embeddings/embeddings_all-MiniLM-L6-v2.npy
2025-06-06 23:03:07,592 - INFO - Generating data visualizations...
2025-06-06 23:03:07,756 - INFO - Saved text length distribution plot
2025-06-06 23:03:07,839 - INFO - Saved class distribution plot
2025-06-06 23:03:07,931 - INFO - Saved length by class plot
2025-06-06 23:03:11,329 - INFO - Saved model lr
2025-06-06 23:03:25,578 - INFO - Saved model rf
2025-06-06 23:03:49,889 - INFO - Saved model mlp
2025-06-06 23:03:52,155 - INFO - Processing and evaluating model: all-mpnet-base-v2
2025-06-06 23:03:52,157 - INFO - Use pytorch device_name: mps
2025-06-06 23:03:52,157 - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-mpnet-base-v2
2025-06-06 23:03:54,269 - INFO - Loaded 52681 samples from data/Combined Data.csv
2025-06-06 23:03:54,272 - INFO - Mental health status distribution in dataset:
2025-06-06 23:03:54,272 - INFO - Normal: 16343 samples
2025-06-06 23:03:54,272 - INFO - Depression: 15404 samples
2025-06-06 23:03:54,272 - INFO - Suicidal: 10652 samples
2025-06-06 23:03:54,272 - INFO - Anxiety: 3841 samples
2025-06-06 23:03:54,272 - INFO - Bipolar: 2777 samples
2025-06-06 23:03:54,272 - INFO - Stress: 2587 samples
2025-06-06 23:03:54,272 - INFO - Personality disorder: 1077 samples
2025-06-06 23:03:54,272 - INFO - Label mapping: {'Anxiety': 0, 'Bipolar': 1, 'Depression': 2, 'Normal': 3, 'Personality disorder': 4, 'Stress': 5, 'Suicidal': 6}
2025-06-06 23:03:54,273 - INFO - Generating embeddings using all-mpnet-base-v2
